!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=31)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,n){e.exports=n(26)(2)},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,a,o;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(a=i;0!=a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=i;0!=a--;)if(!Object.prototype.hasOwnProperty.call(n,o[a]))return!1;for(a=i;0!=a--;){var s=o[a];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s}));const i=(e,t)=>t,a=e=>({state:e,references:[]}),o=(e,t)=>e,s={}},function(e,t){e.exports=__kbnSharedDeps__.Classnames},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return d.a}));var i=n(10);const a=e=>t=>{const n=t.enhancements||{},a=e.getEmbeddableFactory(t.type),o=Object(i.b)(t);let s=o.state;const r=o.references;if(a){const e=a.extract(t);s=e.state,r.push(...e.references)}return s.enhancements={},Object.keys(n).forEach((t=>{if(!n[t])return;const i=e.getEnhancement(t).extract(n[t]);r.push(...i.references),s.enhancements[t]=i.state})),{state:s,references:r}},o=e=>(t,n)=>{const a=t.enhancements||{},o=e.getEmbeddableFactory(t.type);let s=Object(i.c)(t,n);return o&&(s=o.inject(s,n)),s.enhancements={},Object.keys(a).forEach((t=>{a[t]&&(s.enhancements[t]=e.getEnhancement(t).inject(a[t],n))})),s},s=e=>{const t=(n,a)=>{const o=n.enhancements||{},s=e.getEmbeddableFactory(n.type);let r=i.a[a]?i.a[a](n):n;const d="function"==typeof(null==s?void 0:s.migrations)?null==s?void 0:s.migrations():(null==s?void 0:s.migrations)||{};return d[a]&&(r=d[a](r)),null!=s&&s.isContainerType&&(r.panels=(n.panels||[]).map((e=>t(e,a)))),r.enhancements={},Object.keys(o).forEach((t=>{if(!o[t])return;const n=e.getEnhancement(t),i="function"==typeof(null==n?void 0:n.migrations)?null==n?void 0:n.migrations():(null==n?void 0:n.migrations)||{},s=i[a]?i[a](o[t]):o[t];r.enhancements[t]=s})),r};return t},r=e=>(t,n={})=>{const a=t.enhancements||{},o=e.getEmbeddableFactory(t.type);let s=Object(i.d)(t,n);return o&&(s=o.telemetry(t,s)),Object.keys(a).map((t=>{a[t]&&(s=e.getEnhancement(t).telemetry(a[t],s))})),s};var d=n(14)},function(e,t,n){"use strict";let i;n.d(t,"a",(function(){return i})),function(e){e.EDIT="edit",e.PREVIEW="preview",e.PRINT="print",e.VIEW="view"}(i||(i={}))},function(e,t,n){"use strict";function i(e){return Boolean(e.savedObjectId)}n.d(t,"a",(function(){return i}))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.KbnStd},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/savedObjects/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){"use strict";var i,a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function s(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function r(e,t){for(var n={},i=[],a=0;a<e.length;a++){var r=e[a],d=t.base?r[0]+t.base:r[0],l=n[d]||0,c="".concat(d," ").concat(l);n[d]=l+1;var u=s(c),p={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(o[u].references++,o[u].updater(p)):o.push({identifier:c,updater:m(p,t),references:1}),i.push(c)}return i}function d(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var o=n.nc;o&&(i.nonce=o)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var s=a(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var l,c=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function u(e,t,n,i){var a=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=c(t,a);else{var o=document.createTextNode(a),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(o,s[t]):e.appendChild(o)}}function p(e,t,n){var i=n.css,a=n.media,o=n.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var b=null,h=0;function m(e,t){var n,i,a;if(t.singleton){var o=h++;n=b||(b=d(t)),i=u.bind(null,n,o,!1),a=u.bind(null,n,o,!0)}else n=d(t),i=p.bind(null,n,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var n=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var a=s(n[i]);o[a].references--}for(var d=r(e,t),l=0;l<n.length;l++){var c=s(n[l]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}n=d}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,i,a,o=e[1]||"",s=e[3];if(!s)return o;if(t&&"function"==typeof btoa){var r=(n=s,i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(a," */")),d=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[o].concat(d).concat([r]).join("\n")}return[o].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(i)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(a[s]=!0)}for(var r=0;r<e.length;r++){var d=[].concat(e[r]);i&&a[d[0]]||(n&&(d[2]?d[2]="".concat(n," and ").concat(d[2]):d[2]=n),t.push(d))}},t}},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){e.exports=n(26)(3)},function(e,t,n){"use strict";var i=n(21);n.o(i,"IncompatibleActionError")&&n.d(t,"IncompatibleActionError",(function(){return i.IncompatibleActionError})),n.o(i,"buildContextMenuForActions")&&n.d(t,"buildContextMenuForActions",(function(){return i.buildContextMenuForActions}))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.KbnEsQuery},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.Uuid},function(e,t){e.exports=__kbnSharedDeps__.KbnAnalytics},function(e,t){e.exports=__kbnSharedDeps__.ReactDomServer},function(e,t,n){n(32),__kbnBundles__.define("plugin/embeddable/public",n,44),__kbnBundles__.define("plugin/embeddable/common",n,43)},function(e,t,n){n.p=window.__kbnPublicPath__.embeddable},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(34);case"v8light":return n(36)}},function(e,t,n){var i=n(19),a=n(35);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);i(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},function(e,t,n){(t=n(20)(!1)).push([e.i,'.embPanel{display:flex;flex:1;flex-direction:column;height:100%;min-height:26px;position:relative;z-index:auto}.embPanel-isLoading{align-items:center;justify-content:center}.embPanel .embPanel__content{display:flex;flex:1 1 100%;min-height:0;z-index:1}.embPanel .embPanel__content[data-error]{display:none}.embPanel .embPanel__content--fullWidth{width:100%}.embPanel__header{display:flex;flex:0 0 auto;justify-content:flex-end}.embPanel__title{align-items:center;color:#dfe5ef;display:flex;flex-grow:1;flex-wrap:wrap;font-size:12px;font-size:.85714rem;font-weight:700;line-height:1.14286rem;line-height:1.5;overflow:hidden;overflow-wrap:break-word!important;word-break:break-word}.embPanel__title:not(:empty){line-height:24px;padding-left:8px}.embPanel__title .embPanel__titleInner{align-items:center;display:flex;overflow:hidden;padding-right:8px}.embPanel__title .embPanel__titleTooltipAnchor{max-width:100%}.embPanel__title .embPanel__titleText{font-weight:700;max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.embPanel__title .embPanel__placeholderTitleText{color:#535966;font-weight:400}.embPanel--dragHandle:not(.embPanel__title){flex-grow:1}.embPanel__header--floater{left:0;position:absolute;right:0;top:0}.embPanel__header--floater *{z-index:1000}.embPanel__optionsMenuButton{background-color:#d4dae51a;border-bottom-right-radius:0;border-top-left-radius:0}.embPanel__optionsMenuButton:focus{background-color:#36a2ef33}.embPanel__optionsMenuPopover-notification:after{color:#f68fbe;content:"•";font-size:24px;position:absolute;right:0;top:0;transform:translate(50%,-50%)}.embPanel .embPanel__optionsMenuButton{opacity:0}.embPanel .embPanel__optionsMenuButton:focus,.embPanel:hover .embPanel__optionsMenuButton{opacity:1}.embPanel--editing{border-color:#535966!important;border-style:dashed!important;border-width:1px;transition:all .15s cubic-bezier(.694,.0482,.335,1)}.embPanel--editing:focus,.embPanel--editing:hover{box-shadow:0 1px 5px #00000040,0 3.6px 13px rgba(0,0,0,.175),0 8.4px 23px #00000026,0 23px 35px rgba(0,0,0,.125)}.embPanel--editing .embPanel--dragHandle{transition:background-color .15s cubic-bezier(.694,.0482,.335,1)}.embPanel--editing .embPanel--dragHandle:hover{background-color:#f3d3714d;cursor:move}.embPanel--editing .embPanel__optionsMenuButton{opacity:1}.embPanel--loading .embPanel__title{color:#7a7f89}.embPanel__error{padding:24px}.embPanel__error>*{max-height:100%;overflow:auto}.embPanel__label{padding-left:8px;position:absolute;z-index:1000}.embPanel__optionsMenuForm{padding:16px}',""]),e.exports=t},function(e,t,n){var i=n(19),a=n(37);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);i(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},function(e,t,n){(t=n(20)(!1)).push([e.i,'.embPanel{display:flex;flex:1;flex-direction:column;height:100%;min-height:26px;position:relative;z-index:auto}.embPanel-isLoading{align-items:center;justify-content:center}.embPanel .embPanel__content{display:flex;flex:1 1 100%;min-height:0;z-index:1}.embPanel .embPanel__content[data-error]{display:none}.embPanel .embPanel__content--fullWidth{width:100%}.embPanel__header{display:flex;flex:0 0 auto;justify-content:flex-end}.embPanel__title{align-items:center;color:#1a1c21;display:flex;flex-grow:1;flex-wrap:wrap;font-size:12px;font-size:.85714rem;font-weight:700;line-height:1.14286rem;line-height:1.5;overflow:hidden;overflow-wrap:break-word!important;word-break:break-word}.embPanel__title:not(:empty){line-height:24px;padding-left:8px}.embPanel__title .embPanel__titleInner{align-items:center;display:flex;overflow:hidden;padding-right:8px}.embPanel__title .embPanel__titleTooltipAnchor{max-width:100%}.embPanel__title .embPanel__titleText{font-weight:700;max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.embPanel__title .embPanel__placeholderTitleText{color:#98a2b3;font-weight:400}.embPanel--dragHandle:not(.embPanel__title){flex-grow:1}.embPanel__header--floater{left:0;position:absolute;right:0;top:0}.embPanel__header--floater *{z-index:1000}.embPanel__optionsMenuButton{background-color:#3437411a;border-bottom-right-radius:0;border-top-left-radius:0}.embPanel__optionsMenuButton:focus{background-color:#0077cc1a}.embPanel__optionsMenuPopover-notification:after{color:#f04e98;content:"•";font-size:24px;position:absolute;right:0;top:0;transform:translate(50%,-50%)}.embPanel .embPanel__optionsMenuButton{opacity:0}.embPanel .embPanel__optionsMenuButton:focus,.embPanel:hover .embPanel__optionsMenuButton{opacity:1}.embPanel--editing{border-color:#98a2b3!important;border-style:dashed!important;border-width:1px;transition:all .15s cubic-bezier(.694,.0482,.335,1)}.embPanel--editing:focus,.embPanel--editing:hover{box-shadow:0 1px 5px #0000001a,0 3.6px 13px #00000012,0 8.4px 23px #0000000f,0 23px 35px #0000000d}.embPanel--editing .embPanel--dragHandle{transition:background-color .15s cubic-bezier(.694,.0482,.335,1)}.embPanel--editing .embPanel--dragHandle:hover{background-color:#fec5141a;cursor:move}.embPanel--editing .embPanel__optionsMenuButton{opacity:1}.embPanel--loading .embPanel__title{color:#69707d}.embPanel__error{padding:24px}.embPanel__error>*{max-height:100%;overflow:auto}.embPanel__label{padding-left:8px;position:absolute;z-index:1000}.embPanel__optionsMenuForm{padding:16px}',""]),e.exports=t},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(39);case"v8light":return n(41)}},function(e,t,n){var i=n(19),a=n(40);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);i(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},function(e,t,n){(t=n(20)(!1)).push([e.i,".errorEmbeddableCompact__popover{height:100%}.errorEmbeddableCompact__popoverAnchor{max-width:100%}.errorEmbeddableCompact__button :hover{text-decoration:underline;-webkit-text-decoration-color:#7a7f89!important;text-decoration-color:#7a7f89!important}.errorEmbeddableCompact__text{color:#7a7f89;font-size:12px}",""]),e.exports=t},function(e,t,n){var i=n(19),a=n(42);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);i(a,{insert:"head",singleton:!1}),e.exports=a.locals||{}},function(e,t,n){(t=n(20)(!1)).push([e.i,".errorEmbeddableCompact__popover{height:100%}.errorEmbeddableCompact__popoverAnchor{max-width:100%}.errorEmbeddableCompact__button :hover{text-decoration:underline;-webkit-text-decoration-color:#69707d!important;text-decoration-color:#69707d!important}.errorEmbeddableCompact__text{color:#69707d;font-size:12px}",""]),e.exports=t},function(e,t,n){"use strict";n.r(t);var i=n(13);n.d(t,"ViewMode",(function(){return i.a}));var a=n(12);n.d(t,"isSavedObjectEmbeddableInput",(function(){return a.e}))},function(e,t,n){"use strict";n.r(t),n.d(t,"ACTION_ADD_PANEL",(function(){return ge})),n.d(t,"ACTION_EDIT_PANEL",(function(){return z})),n.d(t,"AddPanelAction",(function(){return add_panel_action_AddPanelAction})),n.d(t,"isReferenceOrValueEmbeddable",(function(){return Fe})),n.d(t,"Container",(function(){return container_Container})),n.d(t,"CONTEXT_MENU_TRIGGER",(function(){return U})),n.d(t,"contextMenuTrigger",(function(){return $})),n.d(t,"defaultEmbeddableFactoryProvider",(function(){return w})),n.d(t,"EditPanelAction",(function(){return edit_panel_action_EditPanelAction})),n.d(t,"Embeddable",(function(){return embeddable_Embeddable})),n.d(t,"EmbeddableChildPanel",(function(){return embeddable_child_panel_EmbeddableChildPanel})),n.d(t,"EmbeddableFactoryNotFoundError",(function(){return errors_EmbeddableFactoryNotFoundError})),n.d(t,"EmbeddablePanel",(function(){return embeddable_panel_EmbeddablePanel})),n.d(t,"EmbeddableRoot",(function(){return embeddable_root_EmbeddableRoot})),n.d(t,"ErrorEmbeddable",(function(){return error_embeddable_ErrorEmbeddable})),n.d(t,"isEmbeddable",(function(){return p})),n.d(t,"isErrorEmbeddable",(function(){return F})),n.d(t,"openAddPanelFlyout",(function(){return me})),n.d(t,"PANEL_BADGE_TRIGGER",(function(){return G})),n.d(t,"panelBadgeTrigger",(function(){return V})),n.d(t,"PANEL_NOTIFICATION_TRIGGER",(function(){return H})),n.d(t,"panelNotificationTrigger",(function(){return W})),n.d(t,"PanelNotFoundError",(function(){return errors_PanelNotFoundError})),n.d(t,"SELECT_RANGE_TRIGGER",(function(){return K})),n.d(t,"VALUE_CLICK_TRIGGER",(function(){return Y})),n.d(t,"MULTI_VALUE_CLICK_TRIGGER",(function(){return J})),n.d(t,"CELL_VALUE_TRIGGER",(function(){return Z})),n.d(t,"cellValueTrigger",(function(){return ee})),n.d(t,"ViewMode",(function(){return v.a})),n.d(t,"withEmbeddableSubscription",(function(){return N})),n.d(t,"genericEmbeddableInputIsEqual",(function(){return E})),n.d(t,"omitGenericEmbeddableInput",(function(){return j})),n.d(t,"isSavedObjectEmbeddableInput",(function(){return k.a})),n.d(t,"isRangeSelectTriggerContext",(function(){return ie})),n.d(t,"isValueClickTriggerContext",(function(){return te})),n.d(t,"isMultiValueClickTriggerContext",(function(){return ne})),n.d(t,"isRowClickTriggerContext",(function(){return ae})),n.d(t,"isContextMenuTriggerContext",(function(){return oe})),n.d(t,"EmbeddableStateTransfer",(function(){return embeddable_state_transfer_EmbeddableStateTransfer})),n.d(t,"EmbeddableRenderer",(function(){return L})),n.d(t,"useEmbeddableFactory",(function(){return D})),n.d(t,"isFilterableEmbeddable",(function(){return Se})),n.d(t,"shouldFetch$",(function(){return ke})),n.d(t,"shouldRefreshFilterCompareOptions",(function(){return Ne})),n.d(t,"AttributeService",(function(){return attribute_service_AttributeService})),n.d(t,"ATTRIBUTE_SERVICE_KEY",(function(){return De})),n.d(t,"plugin",(function(){return Ve})),n(33);var i=n(1),a=n.n(i),o=n(3),s=n.n(o),r=n(6),d=n(24),l=n(18),c=n(27),u=n(4);class errors_PanelNotFoundError extends Error{constructor(){super(u.i18n.translate("embeddableApi.errors.paneldoesNotExist",{defaultMessage:"Panel not found"})),a()(this,"code","PANEL_NOT_FOUND")}}class errors_EmbeddableFactoryNotFoundError extends Error{constructor(e){super(u.i18n.translate("embeddableApi.errors.embeddableFactoryNotFound",{defaultMessage:"{type} can't be loaded. Please upgrade to the default distribution of Elasticsearch and Kibana with the appropriate license.",values:{type:e}})),a()(this,"code","EMBEDDABLE_FACTORY_NOT_FOUND")}}const p=e=>!!e&&"object"==typeof e&&"string"==typeof e.id&&"function"==typeof e.getInput&&"function"==typeof e.supportedTriggers;var b=n(9),h=n.n(b),m=n(7),g=n(5),f=n(15),v=n(13);const y=["lastReloadRequestTime","executionContext","searchSessionId","hidePanelTitles","disabledActions","disableTriggers","enhancements","syncColors","syncCursor","syncTooltips","viewMode","title","id"],_=["hidePanelTitles","disabledActions","disableTriggers","enhancements","syncColors","syncCursor","syncTooltips","title","id"],j=e=>Object(r.omit)(e,y),E=(e,t)=>{const{title:n,hidePanelTitles:i,...a}=Object(r.pick)(e,_),{title:o,hidePanelTitles:s,...d}=Object(r.pick)(t,_);return n===o&&Boolean(i)===Boolean(s)&&!!h()(a,d)};function x(e,t){var n;return e.hidePanelTitles?"":null!==(n=e.title)&&void 0!==n?n:t.defaultTitle}function O(e,t){var n;return e.hidePanelTitles?"":null!==(n=e.description)&&void 0!==n?n:t.defaultDescription}class embeddable_Embeddable{constructor(e,t,n){a()(this,"runtimeId",embeddable_Embeddable.runtimeId++),a()(this,"parent",void 0),a()(this,"isContainer",!1),a()(this,"deferEmbeddableLoad",!1),a()(this,"type",void 0),a()(this,"id",void 0),a()(this,"fatalError",void 0),a()(this,"output",void 0),a()(this,"input",void 0),a()(this,"inputSubject",new m.ReplaySubject(1)),a()(this,"outputSubject",new m.ReplaySubject(1)),a()(this,"input$",this.inputSubject.asObservable()),a()(this,"output$",this.outputSubject.asObservable()),a()(this,"renderComplete",new f.RenderCompleteDispatcher),a()(this,"parentSubscription",void 0),a()(this,"destroyed",!1),this.id=e.id,this.output={title:x(e,t),description:O(e,t),...this.reportsEmbeddableLoad()?{}:{loading:!1,rendered:!0},...t},this.input={viewMode:v.a.EDIT,...e},this.parent=n,this.inputSubject.next(this.input),this.outputSubject.next(this.output),n&&(this.parentSubscription=m.merge(n.getInput$(),n.getOutput$()).subscribe((()=>{if(!n.getInput().panels[this.id])return;const e=n.getInputForChild(this.id);this.onResetInput(e)}))),this.getOutput$().pipe(Object(g.map)((({title:e})=>e||"")),Object(g.distinctUntilChanged)()).subscribe((e=>this.renderComplete.setTitle(e)))}reportsEmbeddableLoad(){return!1}refreshInputFromParent(){if(!this.parent)return;if(!this.parent.getInput().panels[this.id])return;const e=this.parent.getInputForChild(this.id);this.onResetInput(e)}getIsContainer(){return!0===this.isContainer}getUpdated$(){return Object(m.merge)(this.getInput$().pipe(Object(g.skip)(1)),this.getOutput$().pipe(Object(g.skip)(1))).pipe(Object(g.debounceTime)(0))}getInput$(){return this.input$}getOutput$(){return this.output$}getOutput(){return this.output}async getExplicitInputIsEqual(e){const t=this.getExplicitInput();return E(e,t)&&h()(j(e),j(t))}getExplicitInput(){const e=this.getRoot();var t,n,i;return e.getIsContainer()&&null!==(t=null===(n=e.getInput().panels)||void 0===n||null===(i=n[this.id])||void 0===i?void 0:i.explicitInput)&&void 0!==t?t:this.getInput()}getPersistableInput(){return this.getExplicitInput()}getInput(){return this.input}getTitle(){var e;return null!==(e=this.output.title)&&void 0!==e?e:""}getDescription(){var e;return null!==(e=this.output.description)&&void 0!==e?e:""}getRoot(){let e=this;for(;e.parent;)e=e.parent;return e}updateInput(e){if(this.destroyed)throw new Error("Embeddable has been destroyed");this.parent?this.parent.updateInputForChild(this.id,e):this.onInputChanged(e)}render(e){if(this.renderComplete.setEl(e),this.renderComplete.setTitle(this.output.title||""),this.destroyed)throw new Error("Embeddable has been destroyed")}getInspectorAdapters(){}destroy(){this.destroyed=!0,this.inputSubject.complete(),this.outputSubject.complete(),this.parentSubscription&&this.parentSubscription.unsubscribe()}setInitializationFinished(){var e;this.deferEmbeddableLoad&&null!==(e=this.parent)&&void 0!==e&&e.isContainer&&this.parent.setChildLoaded(this)}updateOutput(e){const t={...this.output,...e};h()(this.output,t)||(this.output=t,this.outputSubject.next(this.output))}onFatalError(e){var t;this.fatalError=e,this.outputSubject.error(e),this.deferEmbeddableLoad&&null!==(t=this.parent)&&void 0!==t&&t.isContainer&&this.parent.setChildLoaded(this)}onResetInput(e){if(!h()(this.input,e)){const t=this.input.lastReloadRequestTime;this.input=e,this.inputSubject.next(e),this.updateOutput({title:x(this.input,this.output),description:O(this.input,this.output)}),t!==e.lastReloadRequestTime&&this.reload()}}onInputChanged(e){const t=Object(r.cloneDeep)({...this.input,...e});this.onResetInput(t)}supportedTriggers(){return[]}}a()(embeddable_Embeddable,"runtimeId",0);var P=n(16),I=n(0);function T({children:e,embeddable:t,error:n}){const[i,a]=Object(o.useState)(),s=Object(o.useRef)(null);return Object(o.useEffect)((()=>{var i,o;if(!s.current)return;const d=null!==(i=null==t||null===(o=t.catchError)||void 0===o?void 0:o.bind(t))&&void 0!==i?i:e;if(!d)return;const l=d("string"==typeof n?{message:n,name:""}:n,s.current);if(Object(r.isFunction)(l))return l;Object(P.isPromise)(l)?l.then(a):a(l)}),[e,t,n]),Object(I.jsx)("div",{ref:s},i)}const w=e=>{var t;return{isContainerType:null!==(t=e.isContainerType)&&void 0!==t&&t,canCreateNew:e.canCreateNew?e.canCreateNew.bind(e):()=>!0,getDefaultInput:e.getDefaultInput?e.getDefaultInput.bind(e):()=>({}),getExplicitInput:e.getExplicitInput?e.getExplicitInput.bind(e):()=>Promise.resolve({}),createFromSavedObject:e.createFromSavedObject?e.createFromSavedObject.bind(e):(t,n,i)=>{throw new Error(`Creation from saved object not supported by type ${e.type}`)},create:e.create.bind(e),type:e.type,isEditable:e.isEditable.bind(e),getDisplayName:e.getDisplayName.bind(e),getDescription:e.getDescription?e.getDescription.bind(e):()=>"",getIconType:e.getIconType?e.getIconType.bind(e):()=>"empty",savedObjectMetaData:e.savedObjectMetaData,telemetry:e.telemetry||((e,t)=>t),inject:e.inject||(e=>e),extract:e.extract||(e=>({state:e,references:[]})),migrations:e.migrations||{},grouping:e.grouping}};var C=n(2),A=n(17);function M({editPanelAction:e,embeddable:t,error:n}){const[i,a]=Object(o.useState)(!1),s=Object(o.useMemo)((()=>i?()=>null==e?void 0:e.execute({embeddable:t}):void 0),[e,t,i]),r=Object(o.useMemo)((()=>null==e?void 0:e.getDisplayName({embeddable:t})),[e,t]),d=Object(o.useMemo)((()=>t.getTitle()),[t]),l=Object(o.useMemo)((()=>d?u.i18n.translate("embeddableApi.panel.editPanel.displayName",{defaultMessage:"Edit {value}",values:{value:d}}):r),[r,d]);return Object(o.useEffect)((()=>{const n=Object(m.merge)(t.getInput$(),t.getOutput$()).pipe(Object(m.switchMap)((()=>{var n;return null!==(n=null==e?void 0:e.isCompatible({embeddable:t}))&&void 0!==n?n:Object(m.of)(!1)})),Object(m.distinctUntilChanged)()).subscribe(a);return()=>n.unsubscribe()}),[e,t]),Object(I.jsx)(C.EuiEmptyPrompt,{body:Object(I.jsx)(C.EuiText,{size:"s"},Object(I.jsx)(A.Markdown,{markdown:n.message,openLinksInNewTab:!0,"data-test-subj":"errorMessageMarkdown"})),"data-test-subj":"embeddableStackError",iconType:"alert",iconColor:"danger",layout:"vertical",actions:i&&Object(I.jsx)(C.EuiButtonEmpty,{"aria-label":l,onClick:s,size:"s"},r)})}function F(e){return Boolean(e.fatalError||void 0!==e.error)}n(38);class error_embeddable_ErrorEmbeddable extends embeddable_Embeddable{constructor(e,t,n){super(t,{},n),a()(this,"type","error"),a()(this,"error",void 0),this.error=e}reload(){}render(){const e="string"==typeof this.error?{message:this.error,name:""}:this.error;return Object(I.jsx)(M,{embeddable:this,error:e})}}var S=n(22),R=n.n(S);const N=e=>class WithEmbeddableSubscription extends s.a.Component{constructor(e){super(e),a()(this,"subscription",void 0),a()(this,"mounted",!1),this.state={input:this.props.embeddable.getInput(),output:this.props.embeddable.getOutput()}}componentDidMount(){this.mounted=!0,this.subscription=m.merge(this.props.embeddable.getOutput$(),this.props.embeddable.getInput$()).subscribe((()=>{this.mounted&&this.setState({input:this.props.embeddable.getInput(),output:this.props.embeddable.getOutput()})}))}componentWillUnmount(){this.mounted=!1,this.subscription&&this.subscription.unsubscribe()}render(){return Object(I.jsx)(e,R()({input:this.state.input,output:this.state.output},this.props))}};class embeddable_root_EmbeddableRoot extends s.a.Component{constructor(e){super(e),a()(this,"root",void 0),a()(this,"alreadyMounted",!1),a()(this,"updateNode",(e=>{Object(P.isPromise)(e)?e.then(this.updateNode):this.setState({node:e})})),this.root=s.a.createRef(),this.state={}}componentDidMount(){var e,t;null!==(e=this.root)&&void 0!==e&&e.current&&this.props.embeddable&&(this.alreadyMounted=!0,this.updateNode(null!==(t=this.props.embeddable.render(this.root.current))&&void 0!==t?t:void 0))}componentDidUpdate(e){var t;let n=!1;var i;null!==(t=this.root)&&void 0!==t&&t.current&&this.props.embeddable&&!this.alreadyMounted&&(this.alreadyMounted=!0,this.updateNode(null!==(i=this.props.embeddable.render(this.root.current))&&void 0!==i?i:void 0),n=!0),!n&&this.root&&this.root.current&&this.props.embeddable&&this.alreadyMounted&&this.props.input&&(null==e?void 0:e.input)!==this.props.input&&this.props.embeddable.updateInput(this.props.input)}shouldComponentUpdate({embeddable:e,error:t,input:n,loading:i},{node:a}){return Boolean(t!==this.props.error||i!==this.props.loading||e!==this.props.embeddable||this.root&&this.root.current&&e&&!this.alreadyMounted||n!==this.props.input||a!==this.state.node)}render(){return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",{ref:this.root},this.state.node),this.props.loading&&Object(I.jsx)(C.EuiLoadingSpinner,{"data-test-subj":"embedSpinner"}),this.props.error&&Object(I.jsx)(T,{embeddable:this.props.embeddable,error:this.props.error},(({message:e})=>Object(I.jsx)(C.EuiText,{"data-test-subj":"embedError"},e))))}}var k=n(14);function D({input:e,factory:t,onInputUpdated:n}){const[i,a]=Object(o.useState)(void 0),[r,d]=Object(o.useState)(!1),[l,c]=Object(o.useState)(),u=s.a.useRef(e);return Object(o.useEffect)((()=>{u.current=e}),[e]),Object(o.useEffect)((()=>{let e,n=!1;return a(void 0),d(!0),t.create(u.current).then((t=>{n?t&&t.destroy():(e=t,a(t))})).catch((e=>{n||c(null==e?void 0:e.message)})).finally((()=>{n||d(!1)})),()=>{n=!0,e&&e.destroy()}}),[t]),Object(o.useEffect)((()=>{if(!i)return;if(F(i))return;if(!n)return;const e=i.getInput$().subscribe((e=>{n(e)}));return()=>{e.unsubscribe()}}),[i,n]),[i,r,l]}const L=e=>function(e){return"factory"in e}(e)?Object(I.jsx)(B,e):Object(I.jsx)(embeddable_root_EmbeddableRoot,{embeddable:e.embeddable,input:e.input}),B=({factory:e,input:t,onInputUpdated:n})=>{const[i,a,o]=D({factory:e,input:t,onInputUpdated:n});return Object(I.jsx)(embeddable_root_EmbeddableRoot,{embeddable:i,loading:a,error:o,input:t})},z="editPanel";class edit_panel_action_EditPanelAction{constructor(e,t,n,i){var o;a()(this,"type",z),a()(this,"id",z),a()(this,"order",50),a()(this,"currentAppId",void 0),this.getEmbeddableFactory=e,this.application=t,this.stateTransfer=n,this.getOriginatingPath=i,null!==(o=this.application)&&void 0!==o&&o.currentAppId$&&this.application.currentAppId$.pipe(Object(g.take)(1)).subscribe((e=>this.currentAppId=e))}getDisplayName({embeddable:e}){const t=this.getEmbeddableFactory(e.type);if(!t)throw new errors_EmbeddableFactoryNotFoundError(e.type);return u.i18n.translate("embeddableApi.panel.editPanel.displayName",{defaultMessage:"Edit {value}",values:{value:t.getDisplayName()}})}getIconType(){return"pencil"}async isCompatible({embeddable:e}){const t=Boolean(e&&e.getOutput().editable&&(e.getOutput().editUrl||e.getOutput().editApp&&e.getOutput().editPath||e.getOutput().editableWithExplicitInput)),n=e.getInput().viewMode===v.a.EDIT;return Boolean(t&&n)}async execute(e){const t=e.embeddable,{editableWithExplicitInput:n}=t.getOutput();if(n){var i;const e=this.getEmbeddableFactory(t.type);if(!e)throw new errors_EmbeddableFactoryNotFoundError(t.type);const n=t.getExplicitInput(),a=await e.getExplicitInput(n);return void(null===(i=t.parent)||void 0===i||i.replaceEmbeddable(t.id,a))}const a=this.getAppTarget(e);if(a)return void(this.stateTransfer&&a.state?await this.stateTransfer.navigateToEditor(a.app,{path:a.path,state:a.state}):await this.application.navigateToApp(a.app,{path:a.path}));const o=await this.getHref(e);o&&(window.location.href=o)}getAppTarget({embeddable:e}){const t=e?e.getOutput().editApp:void 0,n=e?e.getOutput().editPath:void 0;if(t&&n){if(this.currentAppId){var i;const a=!e.getInput().savedObjectId,o=null===(i=this.getOriginatingPath)||void 0===i?void 0:i.call(this);return{app:t,path:n,state:{originatingApp:this.currentAppId,valueInput:a?this.getExplicitInput({embeddable:e}):void 0,embeddableId:e.id,searchSessionId:e.getInput().searchSessionId,originatingPath:o}}}return{app:t,path:n}}}async getHref({embeddable:e}){return(e?e.getOutput().editUrl:void 0)||""}getExplicitInput({embeddable:e}){var t,n,i,a,o;return null!==(t=null===(n=e.getRoot())||void 0===n||null===(i=n.getInput())||void 0===i||null===(a=i.panels)||void 0===a||null===(o=a[e.id])||void 0===o?void 0:o.explicitInput)&&void 0!==t?t:e.getInput()}}const U="CONTEXT_MENU_TRIGGER",$={id:U,title:u.i18n.translate("embeddableApi.contextMenuTrigger.title",{defaultMessage:"Context menu"}),description:u.i18n.translate("embeddableApi.contextMenuTrigger.description",{defaultMessage:"A new action will be added to the panel's context menu"})},G="PANEL_BADGE_TRIGGER",V={id:G,title:u.i18n.translate("embeddableApi.panelBadgeTrigger.title",{defaultMessage:"Panel badges"}),description:u.i18n.translate("embeddableApi.panelBadgeTrigger.description",{defaultMessage:"Actions appear in title bar when an embeddable loads in a panel."})},H="PANEL_NOTIFICATION_TRIGGER",W={id:H,title:u.i18n.translate("embeddableApi.panelNotificationTrigger.title",{defaultMessage:"Panel notifications"}),description:u.i18n.translate("embeddableApi.panelNotificationTrigger.description",{defaultMessage:"Actions appear in top-right corner of a panel."})},K="SELECT_RANGE_TRIGGER",q={id:K,title:u.i18n.translate("embeddableApi.selectRangeTrigger.title",{defaultMessage:"Range selection"}),description:u.i18n.translate("embeddableApi.selectRangeTrigger.description",{defaultMessage:"A range of values on the visualization"})},Y="VALUE_CLICK_TRIGGER",Q={id:Y,title:u.i18n.translate("embeddableApi.valueClickTrigger.title",{defaultMessage:"Single click"}),description:u.i18n.translate("embeddableApi.valueClickTrigger.description",{defaultMessage:"A data point click on the visualization"})},J="MULTI_VALUE_CLICK_TRIGGER",X={id:J,title:u.i18n.translate("embeddableApi.multiValueClickTrigger.title",{defaultMessage:"Multi click"}),description:u.i18n.translate("embeddableApi.multiValueClickTrigger.description",{defaultMessage:"Selecting multiple values of a single dimension on the visualization"})},Z="CELL_VALUE_TRIGGER",ee={id:Z,title:u.i18n.translate("embeddableApi.cellValueTrigger.title",{defaultMessage:"Cell value"}),description:u.i18n.translate("embeddableApi.cellValueTrigger.description",{defaultMessage:"Actions appear in the cell value options on the visualization"})},te=e=>e.data&&"data"in e.data,ne=e=>e.data&&"data"in e.data&&!Array.isArray(e.data.data),ie=e=>e.data&&"range"in e.data,ae=e=>!!e.data&&"object"==typeof e.data&&"number"==typeof e.data.rowIndex,oe=e=>!!e&&"object"==typeof e&&!!e.embeddable&&"object"==typeof e.embeddable;var se=n(28);const re=e=>Object.keys(e);class container_Container extends embeddable_Embeddable{constructor(e,t,n,i,o){super(e,t,i),a()(this,"isContainer",!0),a()(this,"children",{}),a()(this,"subscription",void 0),a()(this,"anyChildOutputChange$",void 0),this.getFactory=n,this.getFactory=n;const s=Boolean((null==o?void 0:o.initializeSequentially)||(null==o?void 0:o.childIdInitializeOrder)),r=(null!=o&&o.readyToInitializeChildren$?null==o?void 0:o.readyToInitializeChildren$:this.getInput$()).pipe(Object(g.take)(1),Object(g.mergeMap)((async e=>{const t=this.initializeChildEmbeddables(e,o);s&&await t}))),d=this.getInput$().pipe(Object(g.pairwise)());this.subscription=r.pipe(Object(g.combineLatestWith)(d)).subscribe((([e,[{panels:t},{panels:n}]])=>{this.maybeUpdateChildren(n,t)})),this.anyChildOutputChange$=this.getOutput$().pipe(Object(g.map)((()=>this.getChildIds())),Object(g.distinctUntilChanged)(h.a),Object(g.switchMap)((e=>Object(m.merge)(...e.map((e=>this.getChild(e).getOutput$().pipe(Object(g.catchError)((()=>m.EMPTY)),Object(g.map)((()=>e)))))))))}setChildLoaded(e){this.input.panels[e.id]?(this.children[e.id]=e,this.updateOutput({embeddableLoaded:{...this.output.embeddableLoaded,[e.id]:!0}})):e.destroy()}updateInputForChild(e,t){if(!this.input.panels[e])throw new errors_PanelNotFoundError;const n={panels:{...this.input.panels,[e]:{...this.input.panels[e],explicitInput:{...this.input.panels[e].explicitInput,...t}}}};this.updateInput(n)}reload(){Object.values(this.children).forEach((e=>e.reload()))}async addNewEmbeddable(e,t){const n=this.getFactory(e);if(!n)throw new errors_EmbeddableFactoryNotFoundError(e);const i=this.createNewPanelState(n,t);return this.createAndSaveEmbeddable(e,i)}async replaceEmbeddable(e,t,n){if(!this.input.panels[e])throw new errors_PanelNotFoundError;if(n&&n!==this.input.panels[e].type){if(!this.getFactory(n))throw new errors_EmbeddableFactoryNotFoundError(n);this.updateInput({panels:{...this.input.panels,[e]:{...this.input.panels[e],explicitInput:{...t,id:e},type:n}}})}else this.updateInputForChild(e,t);await this.untilEmbeddableLoaded(e)}removeEmbeddable(e){const t=this.onRemoveEmbeddable(e);this.updateInput({panels:t})}onRemoveEmbeddable(e){const t={...this.input.panels};return delete t[e],t}getChildIds(){return Object.keys(this.children)}getChild(e){return this.children[e]}getInputForChild(e){const t=this.getInheritedInput(e),n=this.getPanelState(e),i=n.explicitInput,a={};return re(n.explicitInput).forEach((e=>{void 0===i[e]&&void 0!==t[e]||(a[e]=i[e])})),{...t,...a}}getAnyChildOutputChange$(){return this.anyChildOutputChange$}destroy(){var e;super.destroy(),Object.values(this.children).forEach((e=>e.destroy())),null===(e=this.subscription)||void 0===e||e.unsubscribe()}async untilEmbeddableLoaded(e){if(!this.input.panels[e])throw new errors_PanelNotFoundError;return this.output.embeddableLoaded[e]?this.children[e]:new Promise(((t,n)=>{const i=Object(m.merge)(this.getOutput$(),this.getInput$()).subscribe((()=>{this.output.embeddableLoaded[e]&&(i.unsubscribe(),t(this.children[e])),void 0===this.input.panels[e]&&(i.unsubscribe(),t(void 0))}))}))}async getExplicitInputIsEqual(e){const{panels:t,...n}=e,{panels:i,...a}=this.getInput();if(!Object(r.isEqual)(n,a))return!1;const o=Object.keys(t),s=Object.keys(i);if(o.length!==s.length||Object(r.xor)(o,s).length>0)return!1;for(const e of o){const n=await this.untilEmbeddableLoaded(e),i=t[e].explicitInput;if(!F(n)&&!await n.getExplicitInputIsEqual(i))return!1}return!0}createNewPanelState(e,t={}){const n=t.id||Object(se.v4)(),i=this.createNewExplicitEmbeddableInput(n,e,t);return{type:e.type,explicitInput:{...i,id:n}}}getPanelState(e){if(void 0===this.input.panels[e])throw new errors_PanelNotFoundError;return this.input.panels[e]}async initializeChildEmbeddables(e,t){let n=Object.keys(e.panels);if(null!=t&&t.childIdInitializeOrder){const e=new Set;for(const i of[...t.childIdInitializeOrder,...n])!e.has(i)&&Boolean(this.getInput().panels[i])&&e.add(i);n=Array.from(e)}for(const i of n)if(null!=t&&t.initializeSequentially){const t=await this.onPanelAdded(e.panels[i]);t&&!F(t)&&await this.untilEmbeddableLoaded(i)}else this.onPanelAdded(e.panels[i])}async createAndSaveEmbeddable(e,t){return this.updateInput({panels:{...this.input.panels,[t.explicitInput.id]:t}}),await this.untilEmbeddableLoaded(t.explicitInput.id)}createNewExplicitEmbeddableInput(e,t,n={}){const i=this.getInheritedInput(e),a=t.getDefaultInput(n),o=n;return re(a).forEach((e=>{void 0===i[e]&&void 0===o[e]&&(o[e]=a[e])})),o}onPanelRemoved(e){const t=this.getChild(e);t&&(t.destroy(),delete this.children[e]),this.updateOutput({embeddableLoaded:{...this.output.embeddableLoaded,[e]:void 0}})}async onPanelAdded(e){let t;this.updateOutput({embeddableLoaded:{...this.output.embeddableLoaded,[e.explicitInput.id]:!1}});const n=this.getInputForChild(e.explicitInput.id);try{const i=this.getFactory(e.type);if(!i)throw new errors_EmbeddableFactoryNotFoundError(e.type);t=Object(k.a)(n)?await i.createFromSavedObject(n.savedObjectId,n,this):await i.create(n,this)}catch(n){t=new error_embeddable_ErrorEmbeddable(n,{id:e.explicitInput.id},this)}return t?t.deferEmbeddableLoad||this.setChildLoaded(t):void 0===t&&this.removeEmbeddable(e.explicitInput.id),t}panelHasChanged(e,t){if(e.type!==t.type)return!0}maybeUpdateChildren(e,t){Object.keys({...e,...this.output.embeddableLoaded}).forEach((n=>void 0!==e[n]&&void 0===this.output.embeddableLoaded[n]?this.onPanelAdded(e[n]):void 0===e[n]&&void 0!==this.output.embeddableLoaded[n]?this.onPanelRemoved(n):void(e[n]&&t[n]&&this.panelHasChanged(e[n],t[n])&&(this.onPanelRemoved(n),this.onPanelAdded(e[n])))))}}var de=n(11),le=n.n(de);class embeddable_child_panel_EmbeddableChildPanel extends s.a.Component{constructor(e){super(e),a()(this,"mounted",void 0),a()(this,"embeddable",void 0),a()(this,"subscription",new m.Subscription),this.state={firstTimeLoading:!0},this.mounted=!1}getEventStatus(e){return Object(r.isNil)(e.error)?!0===e.rendered?"rendered":!1===e.loading?"loaded":"loading":"error"}async componentDidMount(){this.mounted=!0;const{container:e}=this.props;if(this.embeddable=await e.untilEmbeddableLoaded(this.props.embeddableId),this.mounted){var t;let e=0;null===(t=this.subscription)||void 0===t||t.add(this.embeddable.getOutput$().pipe(Object(g.map)((t=>(!0===t.loading&&(e=performance.now()),{id:this.embeddable.id,status:this.getEventStatus(t),error:t.error}))),Object(g.distinct)((t=>e+t.id+t.status+!!t.error)),Object(g.map)((t=>({...t,timeToEvent:performance.now()-e})))).subscribe((e=>{this.props.onPanelStatusChange&&this.props.onPanelStatusChange(e)}))),this.setState({firstTimeLoading:!1})}}componentWillUnmount(){this.mounted=!1,this.subscription&&this.subscription.unsubscribe()}render(){const{PanelComponent:e,index:t}=this.props,n=le()("embPanel",{"embPanel-isLoading":this.state.firstTimeLoading});return Object(I.jsx)("div",{className:n},this.state.firstTimeLoading||!this.embeddable?Object(I.jsx)(C.EuiLoadingChart,{size:"l",mono:!0}):Object(I.jsx)(e,{embeddable:this.embeddable,index:t}))}}var ce=n(23);const ue="openInspector";class inspect_panel_action_InspectPanelAction{constructor(e){a()(this,"type",ue),a()(this,"id",ue),a()(this,"order",20),this.inspector=e}getDisplayName(){return u.i18n.translate("embeddableApi.panel.inspectPanel.displayName",{defaultMessage:"Inspect"})}getIconType(){return"inspect"}async isCompatible({embeddable:e}){return this.inspector.isAvailable(e.getInspectorAdapters())}async execute({embeddable:e}){const t=e.getInspectorAdapters();if(!await this.isCompatible({embeddable:e})||void 0===t)throw new Error("Action not compatible with context");const n=this.inspector.open(t,{title:e.getTitle(),options:{fileName:e.getTitle()||e.getInput().title||e.getOutput().defaultTitle||u.i18n.translate("embeddableApi.panel.inspectPanel.untitledEmbeddableFilename",{defaultMessage:"untitled"})}}),i=e.destroy;e.destroy=()=>{n.close(),i&&i.call(e)},n.onClose.finally((()=>{e.destroy=i}))}}var pe=n(8),be=n(29);function he({menuItems:e}){const[t,n]=Object(o.useState)(!1);return Object(I.jsx)(C.EuiPopover,{id:"createNew",button:Object(I.jsx)(C.EuiButton,{"data-test-subj":"createNew",iconType:"plusInCircle",iconSide:"left",onClick:()=>{n(!t)},fill:!0},Object(I.jsx)(pe.FormattedMessage,{id:"embeddableApi.addPanel.createNewDefaultOption",defaultMessage:"Create new"})),isOpen:t,closePopover:()=>{n(!1)},panelPaddingSize:"none",anchorPosition:"downRight"},Object(I.jsx)(C.EuiContextMenuPanel,{items:e}))}class add_panel_flyout_AddPanelFlyout extends s.a.Component{constructor(e){super(e),a()(this,"lastToast",void 0),a()(this,"state",{isCreateMenuOpen:!1}),a()(this,"showToast",(e=>{this.lastToast&&this.props.notifications.toasts.remove(this.lastToast),this.lastToast=this.props.notifications.toasts.addSuccess({title:u.i18n.translate("embeddableApi.addPanel.savedObjectAddedToContainerSuccessMessageTitle",{defaultMessage:"{savedObjectName} was added",values:{savedObjectName:e}}),"data-test-subj":"addObjectToContainerSuccess"})})),a()(this,"createNewEmbeddable",(async e=>{this.props.onClose();const t=this.props.getFactory(e);if(!t)throw new errors_EmbeddableFactoryNotFoundError(e);const n=await t.getExplicitInput(),i=await this.props.container.addNewEmbeddable(e,n);i&&this.showToast(i.getInput().title||"")})),a()(this,"onAddPanel",(async(e,t,n,i)=>{const a=[...this.props.getAllFactories()].find((e=>e.savedObjectMetaData&&e.savedObjectMetaData.type===t));if(!a)throw new errors_EmbeddableFactoryNotFoundError(t);this.props.container.addNewEmbeddable(a.type,{savedObjectId:e}),this.doTelemetryForAddEvent(this.props.container.type,a,i),this.showToast(n)}))}doTelemetryForAddEvent(e,t,n){const{reportUiCounter:i}=this.props;if(i){var a;const o=null!==(a=t.savedObjectMetaData)&&void 0!==a&&a.getSavedObjectSubType?t.savedObjectMetaData.getSavedObjectSubType(n):t.type;i(e,be.METRIC_TYPE.CLICK,`${o}:add`)}}getCreateMenuItems(){return[...this.props.getAllFactories()].filter((e=>e.isEditable()&&!e.isContainerType&&e.canCreateNew())).map((e=>Object(I.jsx)(C.EuiContextMenuItem,{key:e.type,"data-test-subj":`createNew-${e.type}`,onClick:()=>this.createNewEmbeddable(e.type),className:"embPanel__addItem"},function([e,...t]){return`${e.toUpperCase()}${t.join("")}`}(e.getDisplayName()))))}render(){const e=this.props.SavedObjectFinder,t=[...this.props.getAllFactories()].filter((e=>Boolean(e.savedObjectMetaData)&&!e.isContainerType)).map((({savedObjectMetaData:e})=>e)),n=Object(I.jsx)(e,{onChoose:this.onAddPanel,savedObjectMetaData:t,showFilter:!0,noItemsMessage:u.i18n.translate("embeddableApi.addPanel.noMatchingObjectsMessage",{defaultMessage:"No matching objects found."})},this.props.showCreateNewMenu?Object(I.jsx)(he,{menuItems:this.getCreateMenuItems()}):null);return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(C.EuiFlyoutHeader,{hasBorder:!0},Object(I.jsx)(C.EuiTitle,{size:"m"},Object(I.jsx)("h2",null,Object(I.jsx)(pe.FormattedMessage,{id:"embeddableApi.addPanel.Title",defaultMessage:"Add from library"})))),Object(I.jsx)(C.EuiFlyoutBody,null,n))}}function me(e){const{embeddable:t,getFactory:n,getAllFactories:i,overlays:a,notifications:o,SavedObjectFinder:s,showCreateNewMenu:r,reportUiCounter:d,theme:l}=e,c=a.openFlyout(Object(A.toMountPoint)(Object(I.jsx)(add_panel_flyout_AddPanelFlyout,{container:t,onClose:()=>{c&&c.close()},getFactory:n,getAllFactories:i,notifications:o,reportUiCounter:d,SavedObjectFinder:s,showCreateNewMenu:r}),{theme$:l.theme$}),{"data-test-subj":"dashboardAddPanel",ownFocus:!0});return c}const ge="ACTION_ADD_PANEL";class add_panel_action_AddPanelAction{constructor(e,t,n,i,o,s,r){a()(this,"type",ge),a()(this,"id",ge),this.getFactory=e,this.getAllFactories=t,this.overlays=n,this.notifications=i,this.SavedObjectFinder=o,this.theme=s,this.reportUiCounter=r}getDisplayName(){return u.i18n.translate("embeddableApi.addPanel.displayName",{defaultMessage:"Add panel"})}getIconType(){return"plusInCircleFilled"}async isCompatible(e){const{embeddable:t}=e;return t.getIsContainer()&&t.getInput().viewMode===v.a.EDIT}async execute(e){const{embeddable:t}=e;if(!t.getIsContainer()||!await this.isCompatible(e))throw new Error("Context is incompatible");me({embeddable:t,getFactory:this.getFactory,getAllFactories:this.getAllFactories,overlays:this.overlays,notifications:this.notifications,SavedObjectFinder:this.SavedObjectFinder,reportUiCounter:this.reportUiCounter,theme:this.theme})}}const fe="deletePanel";class remove_panel_action_RemovePanelAction{constructor(){a()(this,"type",fe),a()(this,"id",fe),a()(this,"order",1)}getDisplayName(){return u.i18n.translate("embeddableApi.panel.removePanel.displayName",{defaultMessage:"Delete from dashboard"})}getIconType(){return"trash"}async isCompatible({embeddable:e}){var t,n;const i=(null===(t=e.parent)||void 0===t||null===(n=t.getExpandedPanelId)||void 0===n?void 0:n.call(t))===e.id;return Boolean(e.parent&&e.getInput().viewMode===v.a.EDIT&&!i)}async execute({embeddable:e}){if(!e.parent||!await this.isCompatible({embeddable:e}))throw new ce.IncompatibleActionError;e.parent.removeEmbeddable(e.id)}}var ve=n(21);function ye(e){if(!e.parent)return!1;const t=e.parent;return!!t.getInput().panels[e.id]&&void 0===t.getInput().panels[e.id].explicitInput.timeRange}const _e=e=>{var t,n;const{onClose:i,embeddable:a,dateFormat:r,timeRangeCompatible:d}=e,l=a.getInput().viewMode===v.a.EDIT,[c,p]=Object(o.useState)(a.getInput().hidePanelTitles),[b,h]=Object(o.useState)(null!==(t=a.getInput().description)&&void 0!==t?t:a.getOutput().defaultDescription),[m,g]=Object(o.useState)(null!==(n=a.getInput().title)&&void 0!==n?n:a.getOutput().defaultTitle),[f,y]=Object(o.useState)(!!d&&ye(a)),[_,j]=Object(o.useState)(d?a.getInput().timeRange:void 0),E=e.commonlyUsedRanges?e.commonlyUsedRanges.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n}))):void 0;return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(C.EuiFlyoutHeader,{hasBorder:!0},Object(I.jsx)(C.EuiTitle,{size:"m"},Object(I.jsx)("h2",null,Object(I.jsx)(pe.FormattedMessage,{id:"embeddableApi.customizePanel.flyout.title",defaultMessage:"Panel settings"})))),Object(I.jsx)(C.EuiFlyoutBody,null,Object(I.jsx)(C.EuiForm,null,l?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(C.EuiFormRow,null,Object(I.jsx)(C.EuiSwitch,{checked:!c,"data-test-subj":"customEmbeddablePanelHideTitleSwitch",disabled:!l,id:"hideTitle",label:Object(I.jsx)(pe.FormattedMessage,{defaultMessage:"Show title",id:"embeddableApi.customizePanel.flyout.optionsMenuForm.showTitle"}),onChange:e=>p(!e.target.checked)})),Object(I.jsx)(C.EuiFormRow,{label:Object(I.jsx)(pe.FormattedMessage,{id:"embeddableApi.customizePanel.flyout.optionsMenuForm.panelTitleFormRowLabel",defaultMessage:"Title"}),labelAppend:Object(I.jsx)(C.EuiButtonEmpty,{size:"xs","data-test-subj":"resetCustomEmbeddablePanelTitleButton",onClick:()=>g(a.getOutput().defaultTitle),disabled:c||!l,"aria-label":u.i18n.translate("embeddableApi.customizePanel.flyout.optionsMenuForm.resetCustomTitleButtonAriaLabel",{defaultMessage:"Reset title"})},Object(I.jsx)(pe.FormattedMessage,{id:"embeddableApi.customizePanel.flyout.optionsMenuForm.resetCustomTitleButtonLabel",defaultMessage:"Reset"}))},Object(I.jsx)(C.EuiFieldText,{id:"panelTitleInput",className:"panelTitleInputText","data-test-subj":"customEmbeddablePanelTitleInput",name:"title",type:"text",disabled:c||!l,value:null!=m?m:"",onChange:e=>g(e.target.value),"aria-label":u.i18n.translate("embeddableApi.customizePanel.flyout.optionsMenuForm.panelTitleInputAriaLabel",{defaultMessage:"Enter a custom title for your panel"})})),Object(I.jsx)(C.EuiFormRow,{label:Object(I.jsx)(pe.FormattedMessage,{id:"embeddableApi.customizePanel.flyout.optionsMenuForm.panelDescriptionFormRowLabel",defaultMessage:"Description"}),labelAppend:Object(I.jsx)(C.EuiButtonEmpty,{size:"xs","data-test-subj":"resetCustomEmbeddablePanelDescriptionButton",onClick:()=>{h(a.getOutput().defaultDescription)},disabled:c||!l,"aria-label":u.i18n.translate("embeddableApi.customizePanel.flyout.optionsMenuForm.resetCustomDescriptionButtonAriaLabel",{defaultMessage:"Reset description"})},Object(I.jsx)(pe.FormattedMessage,{id:"embeddableApi.customizePanel.modal.optionsMenuForm.resetCustomDescriptionButtonLabel",defaultMessage:"Reset"}))},Object(I.jsx)(C.EuiTextArea,{id:"panelDescriptionInput",className:"panelDescriptionInputText","data-test-subj":"customEmbeddablePanelDescriptionInput",disabled:c||!l,name:"description",value:null!=b?b:"",onChange:e=>h(e.target.value),"aria-label":u.i18n.translate("embeddableApi.customizePanel.flyout.optionsMenuForm.panelDescriptionAriaLabel",{defaultMessage:"Enter a custom description for your panel"})}))):null,d?Object(I.jsx)(s.a.Fragment,null,function(e){return!!e.parent&&void 0!==e.parent.getInput().timeRange}(a)?Object(I.jsx)(C.EuiFormRow,null,Object(I.jsx)(C.EuiSwitch,{checked:!f,"data-test-subj":"customizePanelShowCustomTimeRange",id:"showCustomTimeRange",label:Object(I.jsx)(pe.FormattedMessage,{defaultMessage:"Apply custom time range",id:"embeddableApi.customizePanel.flyout.optionsMenuForm.showCustomTimeRangeSwitch"}),onChange:e=>y(!e.target.checked)})):null,f?null:Object(I.jsx)(C.EuiFormRow,{label:Object(I.jsx)(pe.FormattedMessage,{id:"embeddableApi.customizePanel.flyout.optionsMenuForm.panelTimeRangeFormRowLabel",defaultMessage:"Time range"})},Object(I.jsx)(C.EuiSuperDatePicker,{start:null!==(x=null==_?void 0:_.from)&&void 0!==x?x:void 0,end:null!==(O=null==_?void 0:_.to)&&void 0!==O?O:void 0,onTimeChange:({start:e,end:t})=>j({from:e,to:t}),showUpdateButton:!1,dateFormat:r,commonlyUsedRanges:E,"data-test-subj":"customizePanelTimeRangeDatePicker"}))):null)),Object(I.jsx)(C.EuiFlyoutFooter,null,Object(I.jsx)(C.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(I.jsx)(C.EuiFlexItem,{grow:!1},Object(I.jsx)(C.EuiButtonEmpty,{"data-test-subj":"cancelCustomizePanelButton",onClick:i},Object(I.jsx)(pe.FormattedMessage,{id:"embeddableApi.customizePanel.flyout.cancelButtonTitle",defaultMessage:"Cancel"}))),Object(I.jsx)(C.EuiFlexItem,{grow:!1},Object(I.jsx)(C.EuiButton,{"data-test-subj":"saveCustomizePanelButton",onClick:()=>{const e={hidePanelTitles:c,title:m===a.getOutput().defaultTitle?void 0:m,description:b===a.getOutput().defaultDescription?void 0:b};Boolean(d)&&(e.timeRange=f?void 0:_),a.updateInput(e),i()},fill:!0},Object(I.jsx)(pe.FormattedMessage,{id:"embeddableApi.customizePanel.flyout.saveButtonTitle",defaultMessage:"Save"}))))));var x,O},je="ACTION_CUSTOMIZE_PANEL";function Ee(e){return"visualization"===e.type}function xe(e){return void 0!==e.getInput().timeRange}class customize_panel_action_CustomizePanelAction{constructor(e,t,n,i){a()(this,"type",je),a()(this,"id",je),a()(this,"order",40),this.overlays=e,this.theme=t,this.commonlyUsedRanges=n,this.dateFormat=i}isTimeRangeCompatible({embeddable:e}){const t=Ee(e)&&"input_control_vis"===e.getOutput().visTypeName,n=Ee(e)&&"markdown"===e.getOutput().visTypeName,i="image"===e.type;return Boolean(e&&xe(e)&&!t&&!n&&!i)}getDisplayName({embeddable:e}){return u.i18n.translate("embeddableApi.customizePanel.action.displayName",{defaultMessage:"Edit panel settings"})}getIconType(){return"pencil"}async isCompatible({embeddable:e}){return e.getInput().viewMode===v.a.EDIT||this.isTimeRangeCompatible({embeddable:e})}async execute({embeddable:e}){if(!await this.isCompatible({embeddable:e}))throw new ve.IncompatibleActionError;const t=e.getRoot(),n=(i=t,Boolean(i.openOverlay&&i.clearOverlays)?t:void 0);var i;const a=this.overlays.openFlyout(Object(A.toMountPoint)(Object(I.jsx)(_e,{embeddable:e,timeRangeCompatible:this.isTimeRangeCompatible({embeddable:e}),dateFormat:this.dateFormat,commonlyUsedRanges:this.commonlyUsedRanges,onClose:()=>{n&&n.clearOverlays(),a.close()}}),{theme$:this.theme.theme$}),{size:"s","data-test-subj":"customizePanel"});null==n||n.openOverlay(a)}}class panel_options_menu_PanelOptionsMenu extends s.a.Component{static getDerivedStateFromProps(e,t){return e.closeContextMenu?{...t,isPopoverOpen:!1}:t}constructor(e){super(e),a()(this,"mounted",!1),a()(this,"closePopover",(()=>{this.mounted&&this.setState({isPopoverOpen:!1})})),a()(this,"toggleContextMenu",(()=>{this.mounted&&this.setState((({isPopoverOpen:e})=>({isPopoverOpen:!e})),(()=>{this.state.isPopoverOpen&&(this.setState({actionContextMenuPanel:void 0}),this.props.getActionContextMenuPanel().then((e=>{this.mounted&&this.setState({actionContextMenuPanel:e})})).catch((e=>console.error(e))))}))})),this.state={actionContextMenuPanel:void 0,isPopoverOpen:!1,showNotification:!1}}async componentDidMount(){this.mounted=!0,this.setState({actionContextMenuPanel:void 0});const e=await this.props.getActionContextMenuPanel(),t=e.actions.some((e=>e.showNotification));this.mounted&&this.setState({actionContextMenuPanel:e,showNotification:t})}async componentDidUpdate(){const e=(await this.props.getActionContextMenuPanel()).actions.some((e=>e.showNotification));this.mounted&&this.state.showNotification!==e&&this.setState({showNotification:e})}componentWillUnmount(){this.mounted=!1}render(){var e;const{isViewMode:t,title:n,index:i}=this.props,a=u.i18n.translate("embeddableApi.panel.optionsMenu.panelOptionsButtonEnhancedAriaLabel",{defaultMessage:"Panel options for {title}",values:{title:n}}),o=void 0===i?u.i18n.translate("embeddableApi.panel.optionsMenu.panelOptionsButtonAriaLabel",{defaultMessage:"Panel options"}):u.i18n.translate("embeddableApi.panel.optionsMenu.panelOptionsButtonAriaLabelWithIndex",{defaultMessage:"Options for panel {index}",values:{index:i}}),s=Object(I.jsx)(C.EuiButtonIcon,{iconType:t?"boxesHorizontal":"gear",color:"text",className:"embPanel__optionsMenuButton","aria-label":n?a:o,"data-test-subj":"embeddablePanelToggleMenuIcon",onClick:this.toggleContextMenu});return Object(I.jsx)(C.EuiPopover,{className:"embPanel__optionsMenuPopover"+(this.state.showNotification?" embPanel__optionsMenuPopover-notification":""),button:s,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downRight","data-test-subj":this.state.isPopoverOpen?"embeddablePanelContextMenuOpen":"embeddablePanelContextMenuClosed"},Object(I.jsx)(C.EuiContextMenu,{initialPanelId:"mainMenu",panels:(null===(e=this.state.actionContextMenuPanel)||void 0===e?void 0:e.panels)||[]}))}}function Oe({title:e,description:t,index:n,isViewMode:i,hidePanelTitle:a,getActionContextMenuPanel:o,closeContextMenu:r,badges:d,notifications:l,embeddable:c,headerId:p,customizePanel:b}){const h=!a&&(!i||e),m=!i||d.length>0||l.length>0||h||t,g=le()("embPanel__header",{"embPanel__header--floater":!m}),f=u.i18n.translate("embeddableApi.panel.placeholderTitle",{defaultMessage:"[No Title]"}),v=()=>Object(I.jsx)("span",{id:p},m&&e?u.i18n.translate("embeddableApi.panel.enhancedDashboardPanelAriaLabel",{defaultMessage:"Dashboard panel: {title}",values:{title:e||f}}):u.i18n.translate("embeddableApi.panel.dashboardPanelAriaLabel",{defaultMessage:"Dashboard panel"}));if(!m)return Object(I.jsx)("div",{className:g},Object(I.jsx)(panel_options_menu_PanelOptionsMenu,{getActionContextMenuPanel:o,isViewMode:i,closeContextMenu:r,title:e,index:n}),Object(I.jsx)(C.EuiScreenReaderOnly,null,v()));const y=le()("embPanel__title",{"embPanel--dragHandle":!i});return Object(I.jsx)("figcaption",{className:g,"data-test-subj":`embeddablePanelHeading-${(e||"").replace(/\s/g,"")}`},Object(I.jsx)("h2",{"data-test-subj":"dashboardPanelTitle",className:y},Object(I.jsx)(C.EuiScreenReaderOnly,null,v()),(()=>{let n;return h&&(n=i?Object(I.jsx)("span",{className:le()("embPanel__titleText",{embPanel__placeholderTitleText:!e})},e||f):b?Object(I.jsx)(C.EuiLink,{color:"text","data-test-subj":"embeddablePanelTitleLink",className:le()("embPanel__titleText",{embPanel__placeholderTitleText:!e}),"aria-label":u.i18n.translate("embeddableApi.panel.editTitleAriaLabel",{defaultMessage:"Click to edit title: {title}",values:{title:e||f}}),onClick:()=>b.execute({embeddable:c})},e||f):null),t?Object(I.jsx)(C.EuiToolTip,{content:t,delay:"regular",position:"top",anchorClassName:"embPanel__titleTooltipAnchor"},Object(I.jsx)("span",{className:"embPanel__titleInner"},n," ",Object(I.jsx)(C.EuiIcon,{type:"iInCircle",color:"subdued"}))):Object(I.jsx)("span",{className:"embPanel__titleInner"},n)})(),function(e,t){return e.map((e=>Object(I.jsx)(C.EuiBadge,{key:e.id,className:"embPanel__headerBadge",iconType:e.getIconType({embeddable:t,trigger:V}),onClick:()=>e.execute({embeddable:t,trigger:V}),onClickAriaLabel:e.getDisplayName({embeddable:t,trigger:V}),"data-test-subj":`embeddablePanelBadge-${e.id}`},e.getDisplayName({embeddable:t,trigger:V}))))}(d,c)),function(e,t){return e.map((e=>{const n={embeddable:t};let i=e.MenuItem?s.a.createElement(e.MenuItem,{key:e.id,context:{embeddable:t,trigger:W}}):Object(I.jsx)(C.EuiNotificationBadge,{"data-test-subj":`embeddablePanelNotification-${e.id}`,key:e.id,style:{marginTop:"4px",marginRight:"4px"},onClick:()=>e.execute({...n,trigger:W})},e.getDisplayName({...n,trigger:W}));if(e.getDisplayNameTooltip){const t=e.getDisplayNameTooltip({...n,trigger:W});t&&(i=Object(I.jsx)(C.EuiToolTip,{position:"top",delay:"regular",content:t,key:e.id},i))}return i}))}(l,c),Object(I.jsx)(panel_options_menu_PanelOptionsMenu,{isViewMode:i,getActionContextMenuPanel:o,closeContextMenu:r,title:e,index:n}))}const Pe=({order:e},{order:t})=>(t||0)-(e||0);class embeddable_panel_EmbeddablePanel extends s.a.Component{constructor(e){var t,n,i,o;super(e),a()(this,"embeddableRoot",s.a.createRef()),a()(this,"parentSubscription",void 0),a()(this,"subscription",new m.Subscription),a()(this,"mounted",!1),a()(this,"generateId",Object(C.htmlIdGenerator)()),a()(this,"onFocus",(e=>{this.setState({focusedPanelIndex:e})})),a()(this,"onBlur",(e=>{this.state.focusedPanelIndex===e&&this.setState({focusedPanelIndex:void 0})})),a()(this,"closeMyContextMenuPanel",(()=>{this.mounted&&this.setState({closeContextMenu:!0},(()=>{this.mounted&&this.setState({closeContextMenu:!1})}))})),a()(this,"getUniversalActions",(()=>{var e;let t={};return this.props.inspector&&(t={inspectPanel:new inspect_panel_action_InspectPanelAction(this.props.inspector)}),this.props.getEmbeddableFactory&&this.props.getAllEmbeddableFactories&&this.props.overlays&&this.props.notifications&&this.props.SavedObjectFinder&&this.props.application?{...t,customizePanel:new customize_panel_action_CustomizePanelAction(this.props.overlays,this.props.theme,this.props.commonlyUsedRanges,this.props.dateFormat),addPanel:new add_panel_action_AddPanelAction(this.props.getEmbeddableFactory,this.props.getAllEmbeddableFactories,this.props.overlays,this.props.notifications,this.props.SavedObjectFinder,this.props.theme,this.props.reportUiCounter),removePanel:new remove_panel_action_RemovePanelAction,editPanel:new edit_panel_action_EditPanelAction(this.props.getEmbeddableFactory,this.props.application,this.props.stateTransfer,null===(e=this.props.containerContext)||void 0===e?void 0:e.getCurrentPath)}:t})),a()(this,"getActionContextMenuPanel",(async()=>{var e,t,n;let i=null!==(e=await(null===(t=(n=this.props).getActions)||void 0===t?void 0:t.call(n,U,{embeddable:this.props.embeddable})))&&void 0!==e?e:[];const{disabledActions:a}=this.props.embeddable.getInput();if(a){const e=(e=>({id:t})=>-1===e.indexOf(t))(a);i=i.filter(e)}let o=i.concat(Object.values(this.state.universalActions||{})).sort(Pe);return this.props.actionPredicate&&(o=o.filter((({id:e})=>this.props.actionPredicate(e)))),{panels:await Object(ce.buildContextMenuForActions)({actions:o.map((e=>({action:e,context:{embeddable:this.props.embeddable},trigger:$}))),closeMenu:this.closeMyContextMenuPanel}),actions:o}}));const{embeddable:r}=this.props,d=null!==(t=r.getInput().viewMode)&&void 0!==t?t:v.a.EDIT,l=Boolean(null===(n=r.parent)||void 0===n||null===(i=n.getInput())||void 0===i?void 0:i.hidePanelTitles)||Boolean(null===(o=r.getInput())||void 0===o?void 0:o.hidePanelTitles);this.state={universalActions:this.getUniversalActions(),panels:[],viewMode:d,hidePanelTitle:l,closeContextMenu:!1,badges:[],notifications:[]}}async refreshBadges(){var e,t,n;if(!this.mounted)return;if(!1===this.props.showBadges)return;let i=null!==(e=await(null===(t=(n=this.props).getActions)||void 0===t?void 0:t.call(n,G,{embeddable:this.props.embeddable})))&&void 0!==e?e:[];const{disabledActions:a}=this.props.embeddable.getInput();a&&(i=i.filter((e=>-1===a.indexOf(e.id)))),h()(this.state.badges,i)||this.setState({badges:i})}async refreshNotifications(){var e,t,n;if(!this.mounted)return;if(!1===this.props.showNotifications)return;let i=null!==(e=await(null===(t=(n=this.props).getActions)||void 0===t?void 0:t.call(n,H,{embeddable:this.props.embeddable})))&&void 0!==e?e:[];const{disabledActions:a}=this.props.embeddable.getInput();a&&(i=i.filter((e=>-1===a.indexOf(e.id)))),h()(this.state.notifications,i)||this.setState({notifications:i})}UNSAFE_componentWillMount(){this.mounted=!0;const{embeddable:e}=this.props,{parent:t}=e;this.subscription.add(e.getInput$().subscribe((async()=>{var t;this.mounted&&(this.setState({viewMode:null!==(t=e.getInput().viewMode)&&void 0!==t?t:v.a.EDIT}),this.refreshBadges(),this.refreshNotifications())}))),t&&(this.parentSubscription=t.getInput$().subscribe((async()=>{var n,i,a;this.mounted&&t&&(this.setState({hidePanelTitle:Boolean(null===(n=e.parent)||void 0===n||null===(i=n.getInput())||void 0===i?void 0:i.hidePanelTitles)||Boolean(null===(a=e.getInput())||void 0===a?void 0:a.hidePanelTitles)}),this.refreshBadges(),this.refreshNotifications())})))}componentWillUnmount(){var e,t;this.mounted=!1,this.subscription.unsubscribe(),this.parentSubscription&&this.parentSubscription.unsubscribe(),null===(e=(t=this.state).destroyError)||void 0===e||e.call(t),this.props.embeddable.destroy()}render(){const e=[v.a.VIEW,v.a.PRINT].includes(this.state.viewMode),t=le()("embPanel",{"embPanel--editing":!e,"embPanel--loading":this.state.loading}),n={};this.state.loading&&(n["data-loading"]=!0),this.state.error&&(n["data-error"]=!0);const i=this.props.embeddable.getTitle(),a=this.props.embeddable.getDescription(),o=this.generateId(),s=this.props.embeddable.getSelfStyledOptions?this.props.embeddable.getSelfStyledOptions():void 0;return Object(I.jsx)(C.EuiPanel,{className:t,"data-test-subj":"embeddablePanel","data-test-embeddable-id":this.props.embeddable.id,paddingSize:"none",role:"figure","aria-labelledby":o,hasShadow:this.props.showShadow},!this.props.hideHeader&&Object(I.jsx)(Oe,{getActionContextMenuPanel:this.getActionContextMenuPanel,hidePanelTitle:this.state.hidePanelTitle||!(null==s||!s.hideTitle),isViewMode:e,customizePanel:"customizePanel"in this.state.universalActions?this.state.universalActions.customizePanel:void 0,closeContextMenu:this.state.closeContextMenu,title:i,description:a,index:this.props.index,badges:this.state.badges,notifications:this.state.notifications,embeddable:this.props.embeddable,headerId:o}),this.state.error&&Object(I.jsx)(C.EuiFlexGroup,{alignItems:"center",className:"eui-fullHeight embPanel__error","data-test-subj":"embeddableError",justifyContent:"center"},Object(I.jsx)(C.EuiFlexItem,null,Object(I.jsx)(T,{embeddable:this.props.embeddable,error:this.state.error},(e=>Object(I.jsx)(M,{editPanelAction:this.state.universalActions.editPanel,embeddable:this.props.embeddable,error:e}))))),Object(I.jsx)("div",R()({className:"embPanel__content",ref:this.embeddableRoot},n),this.state.node))}componentDidMount(){var e;if(!this.embeddableRoot.current)return;this.subscription.add(this.props.embeddable.getOutput$().subscribe((e=>{this.setState({error:e.error,loading:e.loading})}),(e=>{this.setState({error:e})})));const t=null!==(e=this.props.embeddable.render(this.embeddableRoot.current))&&void 0!==e?e:void 0;Object(P.isPromise)(t)?t.then((e=>this.setState({node:e}))):this.setState({node:t})}}const Ie="embeddable_editor_state";function Te(e){return Ae("originatingApp",e,"string")}const we="embeddable_package_state";function Ce(e){return Ae("type",e,"string")&&Ae("input",e,"object")}function Ae(e,t,n){return Boolean(t)&&e in t&&(!n||typeof t[e]===n)}const Me="EMBEDDABLE_STATE_TRANSFER";class embeddable_state_transfer_EmbeddableStateTransfer{constructor(e,t,n,i){a()(this,"isTransferInProgress",void 0),a()(this,"storage",void 0),a()(this,"appList",void 0),a()(this,"getAppNameFromId",(e=>{var t,n;return null===(t=this.appList)||void 0===t||null===(n=t.get(e))||void 0===n?void 0:n.title})),this.navigateToApp=e,this.storage=i||new f.Storage(sessionStorage),this.isTransferInProgress=!1,this.appList=n,t.subscribe((()=>{this.isTransferInProgress=!1}))}getIncomingEditorState(e,t){return this.getIncomingState(Te,e,Ie,{keysToRemoveAfterFetch:t?[Ie]:void 0})}clearEditorState(e){const t=this.storage.get(Me);var n;t&&(e?null===(n=t[Ie])||void 0===n||delete n[e]:delete t[Ie],this.storage.set(Me,t))}getIncomingEmbeddablePackage(e,t){return this.getIncomingState(Ce,e,we,{keysToRemoveAfterFetch:t?[we]:void 0})}async navigateToEditor(e,t){this.isTransferInProgress=!0,await this.navigateToWithState(e,Ie,{...t})}async navigateToWithEmbeddablePackage(e,t){this.isTransferInProgress=!0,await this.navigateToWithState(e,we,{...t})}getIncomingState(e,t,n,i){var a,o;const s=null===(a=this.storage.get(Me))||void 0===a||null===(o=a[n])||void 0===o?void 0:o[t],d=!e||e(s)?Object(r.cloneDeep)(s):void 0;if(d&&null!=i&&i.keysToRemoveAfterFetch){const e={...this.storage.get(Me)};i.keysToRemoveAfterFetch.forEach((t=>{delete e[t]})),this.storage.set(Me,e)}return d}async navigateToWithState(e,t,n){var i;const a=(null===(i=this.storage.get(Me))||void 0===i?void 0:i[t])||{},o={...this.storage.get(Me),[t]:{...a,[e]:null==n?void 0:n.state}};this.storage.set(Me,o),await this.navigateToApp(e,{path:null==n?void 0:n.path,openInNewTab:null==n?void 0:n.openInNewTab,skipAppLeave:null==n?void 0:n.skipAppLeave})}}function Fe(e){return!!e.inputIsRefType&&!!e.getInputAsValueType&&!!e.getInputAsRefType}function Se(e){return!!e.getFilters&&!!e.getQuery}var Re=n(25);const Ne={...Re.COMPARE_ALL_OPTIONS,state:!1};function ke(e,t){return e.pipe(Object(g.map)((()=>t()))).pipe(Object(g.startWith)(t()),Object(g.distinctUntilChanged)(((e,t)=>!!h()([e.searchSessionId,e.query,e.timeRange,e.timeslice],[t.searchSessionId,t.query,t.timeRange,t.timeslice])&&Object(Re.onlyDisabledFiltersChanged)(e.filters,t.filters,Ne))),Object(g.skip)(1))}const De="attributes";class attribute_service_AttributeService{constructor(e,t,n,i){if(a()(this,"inputIsRefType",(e=>Object(k.a)(e))),a()(this,"getInputAsValueType",(async e=>{if(!this.inputIsRefType(e))return e;const{attributes:t}=await this.unwrapAttributes(e),n=t.title,{savedObjectId:i,...a}=e;return{...a,attributes:Object(r.omit)(t,["title","description"]),title:n}})),a()(this,"getInputAsRefType",(async(e,t)=>this.inputIsRefType(e)?e:new Promise(((n,i)=>{t&&t.showSaveModal&&Object(l.showSaveModal)(Object(I.jsx)(l.SavedObjectSaveModal,{onSave:async t=>{await this.options.checkForDuplicateTitle(t);try{const i={...e[De]};i.title=t.newTitle;const a=await this.wrapAttributes(i,!0),o=Object(r.omit)(e,[De,"title"]);return n({...o,...a}),{id:a.savedObjectId}}catch(e){return i(e),{error:e}}},onClose:()=>{},title:Object(r.get)(t,"saveModalTitle",e[De].title),showCopyOnSave:!1,objectType:this.type,showDescription:!1}))})))),this.type=e,this.toasts=t,this.options=n,i&&!i(this.type))throw new errors_EmbeddableFactoryNotFoundError(this.type)}async defaultUnwrapMethod(e){return Promise.resolve({attributes:{...e}})}async unwrapAttributes(e){return this.inputIsRefType(e)?this.options.unwrapMethod?await this.options.unwrapMethod(e.savedObjectId):await this.defaultUnwrapMethod(e):{attributes:e[De]}}async wrapAttributes(e,t,n){const i=n||{},a=n&&this.inputIsRefType(n)?n.savedObjectId:void 0;if(!t)return{[De]:e};try{const t=await this.options.saveMethod(e,a);return"id"in t?{...i,savedObjectId:t.id}:{...i}}catch(e){return this.toasts.addDanger({title:u.i18n.translate("embeddableApi.attributeService.saveToLibraryError",{defaultMessage:"An error occurred while saving. Error: {errorMessage}",values:{errorMessage:e.message}}),"data-test-subj":"attributeServiceSaveFailure"}),Promise.reject({error:e})}}}var Le=n(12),Be=n(10);const[ze,Ue]=Object(f.createGetterSetter)("Theme");var $e=n(30);const Ge="CUSTOM_TIME_RANGE_BADGE";class custom_time_range_badge_CustomTimeRangeBadge extends customize_panel_action_CustomizePanelAction{constructor(...e){super(...e),a()(this,"type",Ge),a()(this,"id",Ge),a()(this,"order",7)}getDisplayName({embeddable:e}){var t;return Object($e.renderToString)(Object(I.jsx)(C.PrettyDuration,{timeFrom:e.getInput().timeRange.from,timeTo:e.getInput().timeRange.to,dateFormat:null!==(t=this.dateFormat)&&void 0!==t?t:"Browser"}))}getIconType(){return"calendar"}async isCompatible({embeddable:e}){return Boolean(e&&xe(e)&&!ye(e))}}class plugin_EmbeddablePublicPlugin{constructor(e){a()(this,"embeddableFactoryDefinitions",new Map),a()(this,"embeddableFactories",new Map),a()(this,"enhancements",new Map),a()(this,"customEmbeddableFactoryProvider",void 0),a()(this,"stateTransferService",{}),a()(this,"isRegistryReady",!1),a()(this,"appList",void 0),a()(this,"appListSubscription",void 0),a()(this,"registerEnhancement",(e=>{if(this.enhancements.has(e.id))throw new Error(`enhancement with id ${e.id} already exists in the registry`);this.enhancements.set(e.id,{id:e.id,telemetry:e.telemetry||((e,t)=>t),inject:e.inject||r.identity,extract:e.extract||(e=>({state:e,references:[]})),migrations:e.migrations||{}})})),a()(this,"getEnhancement",(e=>this.enhancements.get(e)||{id:"unknown",telemetry:(e,t)=>t,inject:r.identity,extract:e=>({state:e,references:[]}),migrations:{}})),a()(this,"getEmbeddableFactories",(()=>(this.ensureFactoriesExist(),this.embeddableFactories.values()))),a()(this,"registerEmbeddableFactory",((e,t)=>{if(this.embeddableFactoryDefinitions.has(e))throw new Error(`Embeddable factory [embeddableFactoryId = ${e}] already registered in Embeddables API.`);return this.embeddableFactoryDefinitions.set(e,t),()=>this.getEmbeddableFactory(e)})),a()(this,"getEmbeddableFactory",(e=>{if(!this.isRegistryReady)throw new Error("Embeddable factories can only be retrieved after setup lifecycle.");return this.ensureFactoryExists(e),this.embeddableFactories.get(e)})),a()(this,"ensureFactoriesExist",(()=>{this.embeddableFactoryDefinitions.forEach((e=>this.ensureFactoryExists(e.type)))})),a()(this,"ensureFactoryExists",(e=>{if(!this.embeddableFactories.get(e)){const t=this.embeddableFactoryDefinitions.get(e);if(!t)return;this.embeddableFactories.set(e,this.customEmbeddableFactoryProvider?this.customEmbeddableFactoryProvider(t):w(t))}}))}setup(e,{uiActions:t}){return Ue(e.theme),(e=>{e.registerTrigger($),e.registerTrigger(V),e.registerTrigger(W),e.registerTrigger(q),e.registerTrigger(Q),e.registerTrigger(X),e.registerTrigger(ee)})(t),{registerEmbeddableFactory:this.registerEmbeddableFactory,registerEnhancement:this.registerEnhancement,setCustomEmbeddableFactoryProvider:e=>{if(this.customEmbeddableFactoryProvider)throw new Error("Custom embeddable factory provider is already set, and can only be set once");this.customEmbeddableFactoryProvider=e}}}start(e,{uiActions:t,inspector:n}){this.embeddableFactoryDefinitions.forEach((e=>{this.embeddableFactories.set(e.type,this.customEmbeddableFactoryProvider?this.customEmbeddableFactoryProvider(e):w(e))}));const{overlays:i,theme:a,uiSettings:o}=e,s=o.get(d.UI_SETTINGS.DATE_FORMAT),r=o.get(d.UI_SETTINGS.TIMEPICKER_QUICK_RANGES),u=new custom_time_range_badge_CustomTimeRangeBadge(i,a,r,s);t.addTriggerAction(G,u),this.appListSubscription=e.application.applications$.subscribe((e=>{this.appList=e})),this.stateTransferService=new embeddable_state_transfer_EmbeddableStateTransfer(e.application.navigateToApp,e.application.currentAppId$,this.appList),this.isRegistryReady=!0;const p={getEmbeddableFactory:this.getEmbeddableFactory,getEnhancement:this.getEnhancement},b=()=>((e,t,n)=>{const i=new Set;for(const e of Object.keys(Be.a))i.add(e);for(const t of e){const e=t.migrations,n="function"==typeof e?e():e;Object.keys(n).forEach((e=>i.add(e)))}for(const e of t){const t=e.migrations,n="function"==typeof t?t():t;Object.keys(n).forEach((e=>i.add(e)))}const a={};return i.forEach((e=>{a[e]=t=>({...n(t,e)})})),a})(Array.from(this.embeddableFactories.values()),Array.from(this.enhancements.values()),Object(Le.c)(p));return{getEmbeddableFactory:this.getEmbeddableFactory,getEmbeddableFactories:this.getEmbeddableFactories,getAttributeService:(t,n)=>new attribute_service_AttributeService(t,e.notifications.toasts,n,this.getEmbeddableFactory),getStateTransfer:t=>t?new embeddable_state_transfer_EmbeddableStateTransfer(e.application.navigateToApp,e.application.currentAppId$,this.appList,t):this.stateTransferService,EmbeddablePanel:(()=>({embeddable:o,hideHeader:d,containerContext:c,index:u})=>Object(I.jsx)(embeddable_panel_EmbeddablePanel,{hideHeader:d,embeddable:o,index:u,stateTransfer:this.stateTransferService,getActions:t.getTriggerCompatibleActions,getEmbeddableFactory:this.getEmbeddableFactory,getAllEmbeddableFactories:this.getEmbeddableFactories,dateFormat:s,commonlyUsedRanges:r,overlays:i,notifications:e.notifications,application:e.application,inspector:n,SavedObjectFinder:Object(l.getSavedObjectFinder)(e.savedObjects,e.uiSettings),containerContext:c,theme:a}))(),telemetry:Object(Le.d)(p),extract:Object(Le.a)(p),inject:Object(Le.b)(p),getAllMigrations:b,migrateToLatest:e=>Object(c.migrateToLatest)(b(),e)}}stop(){this.appListSubscription&&this.appListSubscription.unsubscribe()}}function Ve(e){return new plugin_EmbeddablePublicPlugin(e)}}]);