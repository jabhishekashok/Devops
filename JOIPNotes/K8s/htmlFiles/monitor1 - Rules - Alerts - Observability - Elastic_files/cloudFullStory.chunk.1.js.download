/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cloudFullStory_bundle_jsonpfunction=window.cloudFullStory_bundle_jsonpfunction||[]).push([[1],{6:function(t,e,n){"use strict";n.r(e),n.d(e,"FullStoryShipper",(function(){return fullstory_shipper_FullStoryShipper}));var i=n(0),o=n.n(i),s=n(5),r=n.n(s);const l=["uid","displayName","email","acctId","website","pageName"];function u(t){return Object.fromEntries(Object.entries(t).map((([t,e])=>Array.isArray(e)?[t,e.filter((t=>void 0!==t))]:[t,e])).filter((([,t])=>void 0!==t&&(!Array.isArray(t)||t.length>0))).map((([t,e])=>{if(l.includes(t))return[t,e];if(function(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)&&!c(t)}(e))return[t,u(e)];const n=function(t){const e=Array.isArray(t),n=e?t[0]:t;let i;switch(typeof n){case"string":i=r()(n,r.a.ISO_8601,!0).isValid()?"date":"str";break;case"number":i=Number.isInteger(n)?"int":"real";break;case"boolean":i="bool";break;case"object":if(c(n)){i="date";break}default:throw new Error("Unsupported type: "+typeof n)}return e?`${i}s`:i}(e);return[n?`${t}_${n}`:t,e]})))}function c(t){return t instanceof Date}function a(t){const[e,n,i]=t.split(".");return{version_str:t,version_major_int:parseInt(e,10),version_minor_int:parseInt(n,10),version_patch_int:parseInt(i,10)}}class fullstory_shipper_FullStoryShipper{constructor(t,e){o()(this,"fullStoryApi",void 0),o()(this,"lastUserId",void 0),o()(this,"eventTypesAllowlist",void 0),this.initContext=e;const{eventTypesAllowlist:n,...i}=t;this.fullStoryApi=function({scriptUrl:t="https://edge.fullstory.com/s/fs.js",fullStoryOrgId:e,host:n="fullstory.com",namespace:i="FS",debug:o=!1}){var s,r,l,u,c,a,p,d;window._fs_debug=o,window._fs_host=n,window._fs_script=t,window._fs_org=e,window._fs_namespace=i,s=window,r=document,l=window._fs_namespace,u="script",c="user",l in s?s.console&&s.console.log&&s.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].'):((p=s[l]=function(t,e,n){p.q?p.q.push([t,e,n]):p._api(t,e,n)}).q=[],(a=r.createElement(u)).async=1,a.crossOrigin="anonymous",a.src=_fs_script,(d=r.getElementsByTagName(u)[0]).parentNode.insertBefore(a,d),p.identify=function(t,e,n){p(c,{uid:t},n),e&&p(c,e,n)},p.setUserVars=function(t,e){p(c,t,e)},p.event=function(t,e,n){p("event",{n:t,p:e},n)},p.anonymize=function(){p.identify(!1)},p.shutdown=function(){p("rec",!1)},p.restart=function(){p("rec",!0)},p.log=function(t,e){p("log",[t,e])},p.consent=function(t){p("consent",!arguments.length||t)},p.identifyAccount=function(t,e){a="account",(e=e||{}).acctId=t,p(a,e)},p.clearUserCookie=function(){},p.setVars=function(t,e){p("setVars",[t,e])},p._w={},d="XMLHttpRequest",p._w[d]=s[d],d="fetch",p._w[d]=s[d],s[d]&&(s[d]=function(){return p._w[d].apply(this,arguments)}),p._v="1.3.0");const f=window[i];if(!f)throw new Error("FullStory snippet failed to load. Check browser logs for more information.");return f}(i),this.eventTypesAllowlist=n}extendContext(t){this.initContext.logger.debug(`Received context ${JSON.stringify(t)}`);const{userId:e,isElasticCloudUser:n,...i}=t;e&&e!==this.lastUserId&&(this.initContext.logger.debug(`Calling FS.identify with userId ${e}`),this.fullStoryApi.identify(e),this.lastUserId=e),"boolean"==typeof n&&(this.initContext.logger.debug(`Calling FS.setUserVars with isElasticCloudUser ${n}`),this.fullStoryApi.setUserVars(u({isElasticCloudUser:n}))),Object.keys(i).length&&(i.applicationId&&(i.app_id=i.applicationId),i.entityId&&(i.ent_id=i.entityId),i.cloudId&&(i.org_id=i.cloudId),this.initContext.logger.debug(`Calling FS.setVars with context ${JSON.stringify(i)}`),this.fullStoryApi.setVars("page",{...u(i),...i.version?a(i.version):{}}))}optIn(t){this.initContext.logger.debug(`Setting FS to optIn ${t}`),this.fullStoryApi.consent(t),t?this.fullStoryApi.restart():this.fullStoryApi.shutdown()}reportEvents(t){this.initContext.logger.debug(`Reporting ${t.length} events to FS`),t.filter((t=>{var e,n;return null===(e=null===(n=this.eventTypesAllowlist)||void 0===n?void 0:n.includes(t.event_type))||void 0===e||e})).forEach((t=>{this.fullStoryApi.event(t.event_type,u(t.properties))}))}async flush(){}shutdown(){}}o()(fullstory_shipper_FullStoryShipper,"shipperName","FullStory")}}]);