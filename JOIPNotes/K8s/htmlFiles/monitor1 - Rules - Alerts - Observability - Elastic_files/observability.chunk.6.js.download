/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.observability_bundle_jsonpfunction=window.observability_bundle_jsonpfunction||[]).push([[6,14,19],{102:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(0),o=a(58);function s(){return Object(n.useContext)(o.a)}},103:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(0),o=a(126);function s(){return Object(n.useContext)(o.a)}},110:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0),o=a(50),s=a(10);function r(){const[e,t]=Object(n.useState)({all:!1,read:!1,create:!1,update:!1,delete:!1,push:!1}),a=Object(o.a)().services.application.capabilities,r=Object(o.a)().services.cases.helpers.getUICapabilities(a[s.casesFeatureId]);return Object(n.useEffect)((()=>{t({all:r.all,create:r.create,read:r.read,update:r.update,delete:r.delete,push:r.push})}),[r.all,r.create,r.read,r.update,r.delete,r.push]),e}},111:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(0);const o=Object(n.createContext)({})},116:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"f",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return l}));const n="alert",o="ux",s="synthetics",r="apm",i="infra_logs",l="infra_metrics"},125:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return f}));var n,o=a(0),s=a.n(o),r=a(88),i=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])},n(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),l="html",c="svg",u=function(e,t){var a,n,o,s={};if(e===l)o=document.createElement("div");else{if(e!==c)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');o=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var r=0,i=Object.entries(t.attributes);r<i.length;r++){var u=i[r],d=u[0],p=u[1];o.setAttribute(d,p)}var b={element:o,elementType:e,setPortalProps:function(e){s=e},getInitialPortalProps:function(){return s},mount:function(t,o){if(o!==n){if(b.unmount(),t!==a&&!function(e,t){if(t===l)return e instanceof HTMLElement;if(t===c)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(b.element,o),a=t,n=o}},unmount:function(e){e&&e!==n||a&&n&&(a.replaceChild(n,b.element),a=void 0,n=void 0)}};return b},d=function(e){function t(t){var a=e.call(this,t)||this;return a.addPropsChannel=function(){Object.assign(a.props.node,{setPortalProps:function(e){a.setState({nodeProps:e})}})},a.state={nodeProps:a.props.node.getInitialPortalProps()},a}return i(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,a=t.children,n=t.node;return r.createPortal(o.Children.map(a,(function(t){return o.isValidElement(t)?o.cloneElement(t,e.state.nodeProps):t})),n.element)},t}(o.PureComponent),p=function(e){function t(t){var a=e.call(this,t)||this;return a.placeholderNode=o.createRef(),a.passPropsThroughPortal(),a}return i(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return o.createElement("div",{ref:this.placeholderNode})},t}(o.PureComponent),b=u.bind(null,l),h=(u.bind(null,c),a(7));function f({children:e,setHeaderActionMenu:t,theme$:a}){const n=Object(o.useMemo)((()=>b()),[]);return Object(o.useEffect)((()=>(t((e=>Object(h.toMountPoint)(s.a.createElement(p,{node:n}),{theme$:a})(e))),()=>{n.unmount(),t(void 0)})),[n,t,a]),s.a.createElement(d,{node:n},e)}},126:function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return v}));var n=a(19),o=a(0),s=a.n(o),r=a(23),i=a(87),l=a(7),c=a(116),u=a(33),d=a(24),p=a(102);const b=["apm","uptime","logs","infrastructure","alerts"],h=Object(o.createContext)({}),f=[c.b,c.e,c.c,c.d,c.f,c.a];function v({children:e}){const{http:t}=Object(l.useKibana)().services,[a,v]=Object(o.useState)(""),{absoluteStart:m,absoluteEnd:y}=Object(p.a)(),[j,C]=Object(o.useState)({}),T=Object(r.useRouteMatch)("/exploratory-view");Object(o.useEffect)((()=>{T||Object(i.asyncForEach)(f,(async e=>{var t,a,n,o,s;try{const r=({hasData:t,indices:a,serviceName:n})=>{C((o=>({...o,[e]:{hasData:t,...n?{serviceName:n}:{},...a?{indices:a}:{},status:d.a.SUCCESS}})))};switch(e){case c.f:const i={absoluteTime:{start:m,end:y}},l=await(null===(t=Object(u.a)(e))||void 0===t?void 0:t.hasData(i));r({hasData:null==l?void 0:l.hasData,indices:null==l?void 0:l.indices,serviceName:null==l?void 0:l.serviceName});break;case c.e:const d=await(null===(a=Object(u.a)(e))||void 0===a?void 0:a.hasData());r({hasData:null==d?void 0:d.hasData,indices:null==d?void 0:d.indices});break;case c.b:const p=await(null===(n=Object(u.a)(e))||void 0===n?void 0:n.hasData());r({hasData:null==p?void 0:p.hasData,indices:null==p?void 0:p.indices});break;case c.c:const b=await(null===(o=Object(u.a)(e))||void 0===o?void 0:o.hasData());r({hasData:null==b?void 0:b.hasData,indices:null==b?void 0:b.indices});break;case c.d:const h=await(null===(s=Object(u.a)(e))||void 0===s?void 0:s.hasData());r({hasData:null==h?void 0:h.hasData,indices:null==h?void 0:h.indices})}}catch(t){C((t=>({...t,[e]:{hasData:void 0,status:d.a.FAILURE}})))}}))}),[T]),Object(o.useEffect)((()=>{!async function(){try{const e=await async function({http:e}){try{const{data:t=[]}=await e.get("/api/alerts/_find",{query:{page:1,per_page:20}})||{};return t.filter((({consumer:e})=>b.includes(e)))}catch(e){throw console.error("Error while fetching alerts",e),e}}({http:t});C((t=>({...t,[c.a]:{hasData:e.length>0,status:d.a.SUCCESS}})))}catch(e){C((e=>({...e,[c.a]:{hasData:void 0,status:d.a.FAILURE}})))}}()}),[a,t]);const O=f.every((e=>{var t;const a=null===(t=j[e])||void 0===t?void 0:t.status;return void 0!==a&&a!==d.a.LOADING})),E=Object.keys(j).some((e=>{var t;return!0===(null===(t=j[e])||void 0===t?void 0:t.hasData)}));return s.a.createElement(h.Provider,{value:{hasDataMap:j,hasAnyData:Object(n.isEmpty)(j)?void 0:E,isAllRequestsComplete:O,forceUpdate:a,onRefreshTimeRange:()=>{v(Object(n.uniqueId)())}},children:e})}},235:function(e,t,a){"use strict";a.r(t),a.d(t,"getO11yAlertsTableConfiguration",(function(){return x}));var n=a(15),o=a(10),s=a(0),r=a.n(s),i=a(7),l=a(1);const c=l.i18n.translate("xpack.observability.alerts.actions.addToCase",{defaultMessage:"Add to existing case"}),u=l.i18n.translate("xpack.observability.alerts.actions.addToNewCase",{defaultMessage:"Add to new case"}),d=l.i18n.translate("xpack.observability.alerts.actions.addToCaseDisabled",{defaultMessage:"Add to case is not supported for this selection"});var p=a(110);const b=({onClose:e,onSuccess:t}={})=>{const{cases:a}=Object(i.useKibana)().services,n=Object(p.a)(),o=a.hooks.getUseCasesAddToNewCaseFlyout({onClose:e,onSuccess:t}),r=a.hooks.getUseCasesAddToExistingCaseModal({onClose:e,onRowClick:t});return Object(s.useMemo)((()=>n.create&&n.read?[{label:u,key:"attach-new-case","data-test-subj":"attach-new-case",disableOnQuery:!0,disabledLabel:d,onClick:e=>{const t=e?a.helpers.groupAlertsByRule(e):[];o.open({attachments:t})}},{label:c,key:"attach-existing-case",disableOnQuery:!0,disabledLabel:d,"data-test-subj":"attach-existing-case",onClick:e=>{const t=e?a.helpers.groupAlertsByRule(e):[];r.open({attachments:t})}}]:[]),[a.helpers,o,n.create,n.read,r])};var h=a(175),f=a(142),v=a(99);const m=e=>e.id===n.j?{...e,displayAsText:v.d.alertsTable.reasonColumnDescription}:e.id===n.c?{...e,displayAsText:v.d.alertsTable.durationColumnDescription}:e.id===n.N?{...e,displayAsText:v.d.alertsTable.statusColumnDescription}:e.id===n.hb?{...e,displayAsText:v.d.alertsTable.lastUpdatedColumnDescription}:e,y=[{columnHeaderType:"not-filtered",displayAsText:v.d.alertsTable.statusColumnDescription,id:n.N,initialWidth:110},{columnHeaderType:"not-filtered",displayAsText:v.d.alertsTable.lastUpdatedColumnDescription,id:n.hb,initialWidth:230},{columnHeaderType:"not-filtered",displayAsText:v.d.alertsTable.durationColumnDescription,id:n.c,initialWidth:116},{columnHeaderType:"not-filtered",displayAsText:v.d.alertsTable.reasonColumnDescription,id:n.j,linkField:"*"}];var j=a(5),C=a(92),T=a(129),O=a(50),E=a(114),g=a(39);function w({data:e,eventId:t,ecsData:a,id:n,observabilityRuleTypeRegistry:o,config:i,setFlyoutAlert:l}){var d,b,h;const f=e.reduce(((e,t)=>({...e,[t.field]:t.value})),{}),[m,y]=Object(s.useState)(null),{cases:w,http:D}=Object(O.a)().services,P=Object(s.useMemo)((()=>Object(E.a)(o)),[o])(f),x=Object(s.useCallback)((()=>{y(null)}),[]),A=Object(s.useCallback)((e=>{y((t=>t?null:e))}),[]),k=Object(p.a)(),I=null!==(d=P.fields["kibana.alert.rule.uuid"])&&void 0!==d?d:null,N=n!==g.d&&I?D.basePath.prepend(v.c.observability.ruleDetails(I)):null,M=null!==(b=P.fields["kibana.alert.uuid"])&&void 0!==b?b:null,_="alert-details-o11y"!==n&&M?D.basePath.prepend(v.c.observability.alertDetails(M)):null,R=Object(s.useMemo)((()=>{var t,n;return null!=a&&a._id?[{alertId:null!==(t=null==a?void 0:a._id)&&void 0!==t?t:"",index:null!==(n=null==a?void 0:a._index)&&void 0!==n?n:"",type:C.CommentType.alert,rule:w.helpers.getRuleIdFromEvent({ecs:a,data:null!=e?e:[]})}]:[]}),[a,w.helpers,e]),F=w.hooks.getUseCasesAddToNewCaseFlyout(),S=w.hooks.getUseCasesAddToExistingCaseModal(),U=Object(s.useCallback)((()=>{F.open({attachments:R}),x()}),[F,R,x]),L=Object(s.useCallback)((()=>{S.open({attachments:R}),x()}),[R,x,S]),z=Object(s.useMemo)((()=>[...k.create&&k.read?[r.a.createElement(j.EuiContextMenuItem,{"data-test-subj":"add-to-existing-case-action",onClick:L,size:"s"},c),r.a.createElement(j.EuiContextMenuItem,{"data-test-subj":"add-to-new-case-action",onClick:U,size:"s"},u)]:[],...N?[r.a.createElement(j.EuiContextMenuItem,{key:"viewRuleDetails","data-test-subj":"viewRuleDetails",href:N},v.d.alertsTable.viewRuleDetailsButtonText)]:[],Object(T.a)(P,i)&&_?r.a.createElement(j.EuiContextMenuItem,{key:"viewAlertDetailsPage","data-test-subj":"viewAlertDetailsPage",href:_},v.d.alertsTable.viewAlertDetailsButtonText):r.a.createElement(j.EuiContextMenuItem,{key:"viewAlertDetailsFlyout","data-test-subj":"viewAlertDetailsFlyout",onClick:()=>{x(),l(P)}},v.d.alertsTable.viewAlertDetailsButtonText)]),[k.create,k.read,L,U,N,P,i,_,x,l]),B=z.length<=0?v.d.alertsTable.notEnoughPermissions:v.d.alertsTable.moreActionsTextLabel;return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.EuiFlexItem,null,r.a.createElement(j.EuiToolTip,{content:v.d.alertsTable.viewInAppTextLabel},r.a.createElement(j.EuiButtonIcon,{size:"s",href:D.basePath.prepend(null!==(h=P.link)&&void 0!==h?h:""),iconType:"eye",color:"text","aria-label":v.d.alertsTable.viewInAppTextLabel}))),r.a.createElement(j.EuiFlexItem,null,r.a.createElement(j.EuiPopover,{button:r.a.createElement(j.EuiToolTip,{content:B},r.a.createElement(j.EuiButtonIcon,{display:"empty",size:"s",color:"text",iconType:"boxesHorizontal","aria-label":B,onClick:()=>A(t),"data-test-subj":"alertsTableRowActionMore"})),isOpen:m===t,closePopover:x,panelPaddingSize:"none",anchorPosition:"downLeft"},r.a.createElement(j.EuiContextMenuPanel,{size:"s",items:z}))))}const D=e=>Object.entries(e).reduce(((e,[t,a])=>[...e,{field:t,value:a}]),[]),P=(e,t)=>()=>({renderCustomActionsRow:({alert:a,setFlyoutAlert:n,id:o})=>r.a.createElement(w,{data:D(a),eventId:a._id,ecsData:{_id:a._id,_index:a._index},id:o,observabilityRuleTypeRegistry:e,setFlyoutAlert:n,config:t}),width:120}),x=(e,t)=>({id:o.observabilityFeatureId,casesFeatureId:o.casesFeatureId,columns:y.map(m),getRenderCellValue:({setFlyoutAlert:t})=>Object(f.a)({observabilityRuleTypeRegistry:e,setFlyoutAlert:t}),sort:[{[n.hb]:{order:"desc"}}],useActionsColumn:P(e,t),useBulkActions:b,useInternalFlyout:()=>{const{header:t,body:a,footer:n}=Object(h.b)(e);return{header:t,body:a,footer:n}}})},98:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(0),o=a(111);function s(){return Object(n.useContext)(o.a)}}}]);